Fri Sep 20 15:08:31 2024
-------------------------
CAS V2.15.1-rc1 - (C) Copyright 2000-2012 CHIPMAST TECHNOLOGY CO. LTD.
Main file   : main.asm
Current file: main.asm

     1                        ;********************************************************************************
     2                        ; PROJECT	: Calendar(MC830B)							*
     3                        ; AUTHOR	: WBN										*
     4                        ; REVISION	: 12/03/2012  V1.0	First issue				*
     5                        ; High OSC CLK  : Internal RC 4.4MHz	Fcpu = Fosc/2				*
     6                        ; Function	: 								*
     7                        ;********************************************************************************
     8                        	.CHIP	W65C02S		;cpu的选型
     9                        	;.INCLIST	ON		;宏定义和文件
    10                        	.MACLIST	ON
    11                        ;***************************************
    12                        CODE_BEG	EQU		F000H ;C000H(4K*4次)		;起始地址
    13                        ;***************************************
    14                        
    15                        PROG	SECTION	OFFSET	CODE_BEG				;定义代码段的偏移量从CODE_BEG开始，用于组织程序代码。
    16                        
    17                        ;***************************************
    18                        ;*	header include								;头文件
    19                        ;***************************************
    20                        	.include	50P016.h
     1                        .page0
     2                        .org 	00H
     3                        PA		EQU	01H
     4                        P_PA		EQU	PA
     5                        PAWAKE	EQU	02H
     6                        P_PA_WAKE	EQU	PAWAKE
     7                        PADIR	EQU	04H
     8                        P_PA_DIR	EQU	PADIR
     9                        P_PA_IO		EQU	PADIR
    10                        PB		EQU	05H
    11                        P_PB		EQU	PB
    12                        PBTYPE	EQU	06H
    13                        P_PB_TYPE	EQU	PBTYPE
    14                        PC		EQU	07H
    15                        P_PC 		EQU PC
    16                        PCDIR	EQU	08H
    17                        P_PC_IO 	EQU	PCDIR
    18                        P_PC_DIR	EQU	PCDIR
    19                        PCSEG	EQU	09H
    20                        P_PCSEG		EQU	PCSEG
    21                        PD		EQU	0AH
    22                        PDDIR	EQU 0BH
    23                        PADF0	EQU	0CH
    24                        P_PADF0		EQU	PADF0
    25                        PADF1	EQU	0DH
    26                        IER		EQU	0EH
    27                        P_IER 	EQU IER
    28                        IFR		EQU	0FH
    29                        P_IFR 		EQU IFR
    30                        TMR0	EQU	10H
    31                        P_TMR0		EQU	TMR0
    32                        TMR1	EQU	12H
    33                        P_TMR1  	EQU	TMR1
    34                        TMR2	EQU	14H
    35                        TMRC	EQU	16H
    36                        P_TMRCTRL 	EQU TMRC
    37                        P_TMRC		EQU	TMRC
    38                        bTMR0ON    EQU	   0
    39                        bTMR1ON    EQU	   1
    40                        bLCDON	   EQU	   4
    41                        bAUDON	   EQU	   7
    42                        
    43                        TMCLK	EQU	17H	;
    44                        P_TMRCLK 	EQU TMCLK
    45                        P_TMCLK 	EQU TMCLK
    46                        DIVC	EQU	18H	;
    47                        P_DIVC		EQU	DIVC
    48                        LCDCTRL	EQU	19H	;
    49                        LCDCOM	EQU	1AH	;
    50                        P_LCD_COM	EQU	LCDCOM
    51                        WDTC	EQU	1CH	;
    52                        SYSCLK	EQU	1DH
    53                        P_SYSCLK	EQU	SYSCLK
    54                        sysclk		equ SYSCLK
    55                        HALT	EQU	1EH	;
    56                        P_HALT		EQU	HALT
    57                        AUD0	EQU	1FH	;
    58                        P_AUD		EQU	AUD0
    59                        
    60                        AUDCR	EQU	20H	;
    61                        P_AUD_CTL	EQU	AUDCR
    62                        FRAME	EQU	21H	;
    63                        ;BANK	EQU	23H	;
    64                        MF		EQU	2FH
    65                        
    66                        SPCR	EQU	32H
    67                        SPSR	EQU	33H
    68                        SPDR	EQU	34H
    69                        PAK		EQU	3AH
    70                        PBK		EQU	3BH
    71                        PCK		EQU	3CH
    72                        LVC		EQU	3DH
    73                        FUSE	EQU	3EH
    74                        
    75                        PDSEG	EQU	5CH
    76                        RFCC0	EQU	5DH
    77                        RFCC1	EQU	5EH
    78                        
    79                        .ends
    79                        
    21                        	.INCLUDE	RAM.INC
     1                        .Kdata
     2                        ;***************************************
     3                        ; RAM Address
     4                        ;***************************************
     5                        RamStarAddr		EQU		1800H			;RAM的开始地址
     6                        LCD_RamAddr		EQU		RamStarAddr		;LCD RAM的地址
     7                        Time_Addr		EQU		RamStarAddr+Time_Str_Addr-Page0RamStarAddr ;事件相关数据的地址
     8                        
     9                        
    10                        ;***************************************
    11                        ;Time_Addr		EUQ		B0H
    12                        ;***************************************
    13                        .PAGE0     ;page 0的内存布局
    14                        ;***************************************
    15                        ;	ORG	0098H
    16                        ;---------------------------------------------------------------------
    17                        	ORG	0080H
    18                        Page0RamStarAddr		EQU		$
    19 00:0080: xx xx xx xx   LCDRAM					DS		6*6
    19 00:0080: xx xx xx xx   
    19 00:0080: xx xx xx xx   
    20                        
    21 00:00A4: xx            R_Int_Backup			DS		1
    22                        
    23 00:00A5: xx            Counter_1Hz				DS		1
    24 00:00A6: xx            Counter_4Hz				DS		1
    25 00:00A7: xx            Counter_16Hz			DS		1
    26                        
    27 00:00A8: xx            TimeCnt					DS		1
    28                        
    29 00:00A9: xx            Frame_Counter			DS		1
    30                        
    31 00:00AA: xx            Beep_Serial				DS		1
    32                        
    33 00:00AB: xx            Timer_Flag				DS		1
    34                        ;bit0 = 1 半秒标志
    35                        ;bit1 = 1 走时标志
    36                        ;bit2 = 1 按键提示音标志位
    37                        ;bit3 = 1 计时完成标志位
    38                        ;bit4 = 1 快加标志位
    39                        ;bit5 = 1 Tim1 32Hz计时标志位
    40                        ;bit6 = 1 LCD 4Hz计时
    41                        ;bit7 = 1 Tim0 16Hz计时
    42                        
    43 00:00AC: xx            Sys_Status_Flag			DS		1
    44                        ;bit0 = 1 初始状态，上电进入
    45                        ;bit1 = 1 正计时态
    46                        ;bit2 = 1 倒计时态
    47                        ;bit3 = 1 暂停态
    48                        
    49 00:00AD: xx            Key_Flag				DS		1
    50                        ;bit0 = 1 扫键标志位
    51                        ;bit1 = 1 首次触发
    52                        ;bit2 = 1 按键处理
    53                        
    54 00:00AE: xx            Frame_Flag				DS		1
    55                        ;bit0 = 1 计时开始
    56                        ;bit1 = 1 分钟减时
    57                        ;bit2 = 1 借位发生
    58                        
    59                        
    60 00:00AF: xx            P_PA_IO_Backup      	DS	1	;B
    61 00:00B0: xx            P_PA_Backup         	DS	1	;C
    62 00:00B1: xx            P_PA_WAKE_Backup		DS	1	;D
    63 00:00B2: xx            P_PC_IO_Backup      	DS	1	;E
    64 00:00B3: xx            P_PC_Backup         	DS	1	;F
    65                        ;---------------------------------------
    66                        Time_Str_Addr	EQU		$
    67 00:00B4: xx            R_Time_Sec				DS	1	;时间秒
    68 00:00B5: xx            R_Time_Min				DS	1	;时间分
    69                        
    70                        ;---------------------------------------
    71 00:00B6: xx xx xx xx   P_Temp					DS	16
    71 00:00B6: xx xx xx xx   
    71 00:00B6: xx xx xx xx   
    72                        ;---------------------------------------
    73                        ;---------------------------------------
    74                        ;***************************************
    75                        .ENDS
    76                        ;***************************************
    77                        .Udata
    78                        ;---------------------------------------
    79                        	ORG		1880H
    80                        ;---------------------------------------
    81                        ;---------------------------------------
    82                        .ENDS
    83                        
    83                        
    22                        	.include	50P016.mac
     1                        ;------------------------------------
     2                        PB2_PB2_COMS MACRO
     3                                RMB0    PADF0
     4                                SMB2    PBTYPE ;COMS
     5                                ENDM
     6                        PB2_PB2_NOMS MACRO
     7                                RMB0    PADF0
     8                                RMB2    PBTYPE ;NOMS
     9                                ENDM
    10                        PB2_PWM MACRO
    11                                SMB0    PADF0
    12                                SMB2    PBTYPE ;COMS
    13                                ENDM
    14                        PB3_PB3_COMS MACRO
    15                                RMB1    PADF0
    16                                SMB3    PBTYPE ;NMOS
    17                                ENDM
    18                        PB3_PB3_NOMS MACRO
    19                                RMB1    PADF0
    20                                RMB3    PBTYPE ;CMOS
    21                                ENDM
    22                        PB3_PWM MACRO
    23                                SMB1    PADF0
    24                                SMB3    PBTYPE ;CMOS
    25                                ENDM
    26                        
    27                        PA4_PA4 MACRO
    28                                RMB3    PADF0
    29                                RMB4    PADF0
    30                                ENDM
    31                        PA4_IR_FSUB     MACRO
    32                                SMB3    PADF0
    33                                RMB4    PADF0
    34                                ENDM
    35                        PA4_IR_TMR0_D2  MACRO
    36                                RMB3    PADF0
    37                                SMB4    PADF0
    38                                ENDM
    39                        PA4_IR_TMR0_D3  MACRO
    40                                SMB3    PADF0
    41                                SMB4    PADF0
    42                                ENDM
    43                        
    44                        PA7_PA7 MACRO
    45                                RMB2    PADF0
    46                                ENDM
    47                        
    48                        PA7_EXT MACRO
    49                                SMB2    PADF0 ;falling edge trigger
    50                                ENDM
    51                        
    52                        PC45_PC45       MACRO
    53                                RMB4    PCSEG
    54                                ENDM
    55                        
    56                        PC67_PC67       MACRO
    57                                RMB5    PCSEG
    58                                RMB4    DIVC
    59                                ENDM
    60                        
    61                        PC67_EL01       MACRO
    62                                RMB5    PCSEG
    63                                SMB4    DIVC
    64                                ENDM
    65                        
    66                        PC03_SEG       MACRO
    67                                SMB0    PCSEG
    68                                SMB1    PCSEG
    69                                SMB2    PCSEG
    70                                SMB3    PCSEG
    71                                ENDM
    72                        
    73                        PC45_SEG       MACRO
    74                                SMB4    PCSEG
    75                                ENDM
    76                        PC67_SEG	MACRO
    77                                SMB5    PCSEG
    78                                ENDM
    79                        
    80                        PD03_SEG	MACRO
    81                        		SMB6	PCSEG
    82                                ENDM
    83                        PD03_RFC	MACRO
    84                        		RMB6	PCSEG
    85                        ;		RMB0	PDSEG
    86                        ;		RMB1	PDSEG
    87                        ;		RMB2	PDSEG
    88                        ;		RMB3	PDSEG
    89                        		SMB0	RFCC0
    90                        		SMB1	RFCC0
    91                        		SMB2	RFCC0
    92                        		SMB3	RFCC0
    93                                ENDM
    94                        PD03_PD03	MACRO
    95                        		RMB6	PCSEG
    96                        ;		RMB0	PDSEG
    97                        ;		RMB1	PDSEG
    98                        ;		RMB2	PDSEG
    99                        ;		RMB3	PDSEG
   100                        		RMB0	RFCC0
   101                        		RMB1	RFCC0
   102                        		RMB2	RFCC0
   103                        		RMB3	RFCC0
   104                                ENDM
   105                        PD0_SEG	MACRO
   106                        ;		RMB6	PCSEG
   107                        		SMB0	PDSEG
   108                                ENDM
   109                        PD1_SEG	MACRO
   110                        ;		RMB6	PCSEG
   111                        		SMB1	PDSEG
   112                                ENDM
   113                        PD2_SEG	MACRO
   114                        ;		RMB6	PCSEG
   115                        		SMB2	PDSEG
   116                                ENDM
   117                        PD3_SEG	MACRO
   118                        		RMB6	PCSEG
   119                        		SMB3	PDSEG
   120                                ENDM
   121                        
   122                        PD47_SEG	MACRO
   123                        		SMB7	PCSEG
   124                                ENDM
   125                        PD47_RFC	MACRO
   126                        		RMB7	PCSEG
   127                        ;		RMB4	PDSEG
   128                        ;		RMB5	PDSEG
   129                        ;		RMB6	PDSEG
   130                        ;		RMB7	PDSEG
   131                        		SMB4	RFCC0
   132                        		SMB5	RFCC0
   133                        		SMB6	RFCC0
   134                        		SMB7	RFCC0
   135                                ENDM
   136                        PD47_PD47	MACRO
   137                        		RMB7	PCSEG
   138                        ;		RMB4	PDSEG
   139                        ;		RMB5	PDSEG
   140                        ;		RMB6	PDSEG
   141                        ;		RMB7	PDSEG
   142                        		RMB4	RFCC0
   143                        		RMB5	RFCC0
   144                        		RMB6	RFCC0
   145                        		RMB7	RFCC0
   146                                ENDM
   147                        PD4_SEG	MACRO
   148                        ;		RMB7	PCSEG
   149                        		SMB4	PDSEG
   150                                ENDM
   151                        PD5_SEG	MACRO
   152                        ;		RMB7	PCSEG
   153                        		SMB5	PDSEG
   154                                ENDM
   155                        PD6_SEG	MACRO
   156                        ;		RMB7	PCSEG
   157                        		SMB6	PDSEG
   158                                ENDM
   159                        PD7_SEG	MACRO
   160                        		RMB7	PCSEG
   161                        		SMB7	PDSEG
   162                                ENDM
   163                        
   164                        PC_PD_SEG	MACRO
   165                        		lda		#$FF
   166                        		STA		PCSEG	;S1~S7,S8~S15
   167                                ENDM
   168                        
   169                        LCD_2COM	MACRO
   170                        		SMB0	LCDCOM
   171                        		RMB1	LCDCOM
   172                        		RMB2	LCDCOM
   173                                ENDM
   174                        LCD_3COM	MACRO
   175                        		RMB0	LCDCOM
   176                        		SMB1	LCDCOM
   177                        		RMB2	LCDCOM
   178                                ENDM
   179                        LCD_4COM	MACRO
   180                        		SMB0	LCDCOM
   181                        		SMB1	LCDCOM
   182                        		RMB2	LCDCOM
   183                                ENDM
   184                        LCD_5COM	MACRO
   185                        		RMB0	LCDCOM
   186                        		RMB1	LCDCOM
   187                        		SMB2	LCDCOM
   188                                ENDM
   189                        LCD_6COM	MACRO
   190                        		SMB0	LCDCOM
   191                        		RMB1	LCDCOM
   192                        		SMB2	LCDCOM
   193                                ENDM
   194                        LCD_7COM	MACRO
   195                        		RMB0	LCDCOM
   196                        		SMB1	LCDCOM
   197                        		SMB2	LCDCOM
   198                                ENDM
   199                        LCD_8COM	MACRO
   200                        		SMB0	LCDCOM
   201                        		SMB1	LCDCOM
   202                        		SMB2	LCDCOM
   203                                ENDM
   204                        
   205                        LCD_ENCH_EN		MACRO
   206                        		SMB6	LCDCOM
   207                                ENDM
   208                        LCD_ENCH_DIS	MACRO
   209                        		RMB6	LCDCOM
   210                                ENDM
   211                        
   212                        LCD_C_TYPE	MACRO
   213                        		SMB7	LCDCOM
   214                        		SMB0	PCSEG
   215                        		SMB1	PCSEG
   216                        		SMB2	PCSEG
   217                        		SMB3	PCSEG
   218                                ENDM
   219                        LCD_DRIVE_2	MACRO
   220                        		SMB0	LCDCTRL
   221                        		RMB1	LCDCTRL
   222                                ENDM
   223                        LCD_DRIVE_4	MACRO
   224                        		RMB0	LCDCTRL
   225                        		SMB1	LCDCTRL
   226                                ENDM
   227                        LCD_DRIVE_8	MACRO
   228                        		SMB0	LCDCTRL
   229                        		SMB1	LCDCTRL
   230                                ENDM
   231                        LCD_DRIVE_FULL	MACRO
   232                        		RMB0	LCDCTRL
   233                        		RMB1	LCDCTRL
   234                                ENDM
   235                        LCD_C_1_2_BAIS_3V	MACRO
   236                        		RMB2	LCDCTRL
   237                        		RMB3	LCDCTRL
   238                                ENDM
   239                        LCD_C_1_3_BAIS_3V	MACRO
   240                        		SMB2	LCDCTRL
   241                        		RMB3	LCDCTRL
   242                                ENDM
   243                        LCD_C_1_3_BAIS_4V	MACRO
   244                        		SMB2	LCDCTRL
   245                        		SMB3	LCDCTRL
   246                                ENDM
   247                        
   248                        LCD_R_TYPE	MACRO
   249                        		RMB7	LCDCOM
   250                                ENDM
   251                        LCD_R_1_2_BAIS	MACRO
   252                        		SMB2	LCDCTRL
   253                        		SMB3	LCDCTRL
   254                                ENDM
   255                        LCD_R_1_3_BAIS	MACRO
   256                        		RMB2	LCDCTRL
   257                        		RMB3	LCDCTRL
   258                                ENDM
   259                        LCD_R_1_4_BAIS	MACRO
   260                        		SMB2	LCDCTRL
   261                        		RMB3	LCDCTRL
   262                                ENDM
   263                        ;------------------------------------
   264                        Fext_WEAK       MACRO
   265                                RMB0    SYSCLK
   266                                ENDM
   267                        Fext_STRONG     MACRO
   268                                SMB0    SYSCLK
   269                                ENDM
   270                        
   271                        Fext_OFF        MACRO
   272                                RMB1    SYSCLK
   273                                ENDM
   274                        Fext_ON         MACRO
   275                                SMB1    SYSCLK
   276                                ENDM
   277                        
   278                        Fosc_OFF        MACRO
   279                                RMB2    SYSCLK
   280                                ENDM
   281                        Fosc_ON         MACRO
   282                                SMB2    SYSCLK
   283                                ENDM
   284                        
   285                        Fext_Xtal       MACRO
   286                                RMB3    SYSCLK
   287                                ENDM
   288                        Fext_RC         MACRO
   289                                SMB3    SYSCLK
   290                                ENDM
   291                        
   292                        Fsys_4MHZ MACRO
   293                                RMB4    SYSCLK
   294                                RMB5    SYSCLK
   295                                ENDM
   296                        Fsys_2MHZ MACRO
   297                                SMB4    SYSCLK
   298                                RMB5    SYSCLK
   299                                ENDM
   300                        Fsys_1MHZ MACRO
   301                                RMB4    SYSCLK
   302                                SMB5    SYSCLK
   303                                ENDM
   304                        Fsys_500K MACRO
   305                                SMB4    SYSCLK
   306                                SMB5    SYSCLK
   307                                ENDM
   308                        
   309                        Fsub_Fext MACRO
   310                                SMB6    SYSCLK
   311                                ENDM
   312                        Fsub_32KCLK     MACRO
   313                                RMB6    SYSCLK
   314                                ENDM
   315                        
   316                        Fcpu_Fext  MACRO
   317                                SMB7    SYSCLK
   318                                ENDM
   319                        Fcpu_Fsys  MACRO
   320                                RMB7    SYSCLK
   321                                ENDM
   322                        
   323                        ;------------------------------------
   324                        DIV_8KHZ  MACRO
   325                                RMB0    DIVC
   326                                RMB1    DIVC
   327                        		RMB5	DIVC
   328                                ENDM
   329                        DIV_16KHZ  MACRO
   330                                SMB0    DIVC
   331                                RMB1    DIVC
   332                        		RMB5	DIVC
   333                                ENDM
   334                        DIV_512HZ  MACRO
   335                                RMB0    DIVC
   336                                SMB1    DIVC
   337                        		RMB5	DIVC
   338                                ENDM
   339                        DIV_1KHZ  MACRO
   340                                SMB0    DIVC
   341                                SMB1    DIVC
   342                        		RMB5	DIVC
   343                                ENDM
   344                        DIV_256HZ  MACRO
   345                        		SMB5	DIVC
   346                                ENDM
   347                        ;------------------------------------
   348                        WDTC_CLK_256HZ   MACRO
   349                                RMB0    WDTC
   350                                RMB1    WDTC
   351                                ENDM
   352                        WDTC_CLK_DIV     MACRO
   353                                SMB0    WDTC
   354                                RMB1    WDTC
   355                                ENDM
   356                        WDTC_CLK_TMR1   MACRO
   357                                RMB0    WDTC
   358                                SMB1    WDTC
   359                                ENDM
   360                        WDTC_CLK_LCDS    MACRO
   361                                SMB0    WDTC
   362                                SMB1    WDTC
   363                                ENDM
   364                        
   365                        WDTC_CLR MACRO
   366                                RMB2    WDTC
   367                                ENDM
   368                        
   369                        WDTC_ON  MACRO
   370                                SMB3    WDTC
   371                                ENDM
   372                        WDTC_OFF MACRO
   373                                RMB3    WDTC
   374                                ENDM
   375                        
   376                        IF_WDTC MACRO   LAB
   377                                BBS4    WDTC,LAB
   378                                ENDM
   379                        
   380                        ;------------------------------------
   381                        TMR0_ON MACRO
   382                                SMB0    TMRC
   383                                ENDM
   384                        TMR0_OFF MACRO
   385                                RMB0    TMRC
   386                                ENDM
   387                        TMR0_CLK_FOSC   MACRO
   388                                SMB0    TMCLK
   389                                RMB1    TMCLK
   390                                ENDM
   391                        TMR0_CLK_FSUB    MACRO
   392                                RMB0    TMCLK
   393                                RMB1    TMCLK
   394                                RMB0	PADF1
   395                                ENDM
   396                        TMR0_CLK_128K	macro
   397                        		RMB0    TMCLK
   398                                SMB1    TMCLK
   399                                ENDM
   400                        TMR0_CLK_32K	macro
   401                        		RMB0    TMCLK
   402                                RMB1    TMCLK
   403                                SMB0	PADF1
   404                                ENDM
   405                        TMR0_CLK_1M   MACRO
   406                                SMB0    TMCLK
   407                                SMB1    TMCLK
   408                                RMB6	TMRC
   409                                ENDM
   410                        
   411                        TMR1_ON MACRO
   412                                SMB1    TMRC
   413                                ENDM
   414                        TMR1_OFF MACRO
   415                                RMB1    TMRC
   416                                ENDM
   417                        TMR1_CLK_TMR0   MACRO
   418                                RMB2    TMCLK
   419                                RMB3    TMCLK
   420                                ENDM
   421                        TMR1_CLK_512Hz    MACRO
   422                                SMB2    TMCLK
   423                                RMB3    TMCLK
   424                                ENDM
   425                        TMR1_CLK_128K	macro
   426                        		RMB2    TMCLK
   427                                SMB3    TMCLK
   428                                ENDM
   429                        TMR1_CLK_1M		macro
   430                        		SMB2    TMCLK
   431                                SMB3    TMCLK
   432                                ENDM
   433                        
   434                        TMR2_ON MACRO
   435                                SMB2    TMRC
   436                                ENDM
   437                        TMR2_OFF MACRO
   438                                RMB2    TMRC
   439                                ENDM
   440                        ;TMR2_CLK_1KDIV2    MACRO
   441                        ;       RMB4    TMCLK
   442                        ;        RMB5    TMCLK
   443                        ;        ENDM
   444                        ;TMR2_CLK_1KDIV3    MACRO
   445                        ;        SMB4    TMCLK
   446                        ;        RMB5    TMCLK
   447                        ;        ENDM
   448                        ;TMR2_CLK_FOSCDIV8  MACRO
   449                        ;        RMB4    TMCLK
   450                        ;        SMB5    TMCLK
   451                        ;        ENDM
   452                        ;TMR2_CLK_FSUB      MACRO
   453                        ;        SMB4    TMCLK
   454                        ;        SMB5    TMCLK
   455                        ;        ENDM
   456                        
   457                        
   458                        TONE_2KHZ       MACRO
   459                                RMB2    DIVC
   460                                RMB3    DIVC
   461                                ENDM
   462                        TONE_TMR0_2     MACRO
   463                                SMB2    DIVC
   464                                RMB3    DIVC
   465                                ENDM
   466                        TONE_L       MACRO
   467                                RMB2    DIVC
   468                                SMB3    DIVC
   469                                ENDM
   470                        TONE_H       MACRO
   471                                SMB2    DIVC
   472                                SMB3    DIVC
   473                                ENDM
   474                        ;------------------------------------
   475                        EN_DIV_IRQ     MACRO
   476                                SMB0    IER
   477                                ENDM
   478                        EN_TMR0_IRQ     MACRO
   479                                SMB1    IER
   480                                ENDM
   481                        EN_TMR1_IRQ     MACRO
   482                                SMB2    IER
   483                                ENDM
   484                        EN_TMR2_IRQ     MACRO
   485                                SMB3    IER
   486                                ENDM
   487                        EN_KEY_IRQ      MACRO
   488                                SMB4    IER
   489                                ENDM
   490                        EN_PA_IRQ      MACRO
   491                                SMB4    IER
   492                                ENDM
   493                        EN_EXT_IRQ      MACRO
   494                                SMB5    IER
   495                                ENDM
   496                        EN_LCD_IRQ      MACRO
   497                                SMB6    IER
   498                                ENDM
   499                        
   500                        DIS_DIV_IRQ     MACRO
   501                                RMB0    IER
   502                                ENDM
   503                        DIS_TMR0_IRQ     MACRO
   504                                RMB1    IER
   505                                ENDM
   506                        DIS_TMR1_IRQ     MACRO
   507                                RMB2    IER
   508                                ENDM
   509                        DIS_TMR2_IRQ     MACRO
   510                                RMB3    IER
   511                                ENDM
   512                        DIS_KEY_IRQ      MACRO
   513                                RMB4    IER
   514                                ENDM
   515                        DIS_PA_IRQ		 MACRO
   516                                RMB4    IER
   517                                ENDM
   518                        DIS_EXT_IRQ      MACRO
   519                                RMB5    IER
   520                                ENDM
   521                        DIS_LCD_IRQ      MACRO
   522                                RMB6    IER
   523                                ENDM
   524                        
   525                        CLR_DIV_IRQ_FLAG MACRO
   526                                RMB0    IFR
   527                                ENDM
   528                        CLR_TMR0_IRQ_FLAG      MACRO
   529                                RMB1    IFR
   530                                ENDM
   531                        CLR_TMR1_IRQ_FLAG      MACRO
   532                                RMB2    IFR
   533                                ENDM
   534                        CLR_TMR2_IRQ_FLAG      MACRO
   535                                RMB3    IFR
   536                                ENDM
   537                        CLR_KEY_IRQ_FLAG      MACRO
   538                                RMB4    IFR
   539                                ENDM
   540                        CLR_PA_IRQ_FLAG      MACRO
   541                                RMB4    IFR
   542                                ENDM
   543                        CLR_PA_IRQF      MACRO
   544                                RMB4    IFR
   545                                ENDM
   546                        CLR_EXT_IRQ_FLAG       MACRO
   547                                RMB5    IFR
   548                                ENDM
   549                        CLR_LCD_IRQ_FLAG       MACRO
   550                                RMB6    IFR
   551                                ENDM
   552                        
   553                        IF_DIV_IRQ_FLAG MACRO   LAB1
   554                                BBS0    IFR,LAB1
   555                                ENDM
   556                        IF_TMR0_IRQ_FLAG MACRO   LAB1
   557                                BBS1    IFR,LAB1
   558                                ENDM
   559                        IF_TMR1_IRQ_FLAG MACRO   LAB1
   560                                BBS2    IFR,LAB1
   561                                ENDM
   562                        IF_TMR2_IRQ_FLAG MACRO   LAB1
   563                                BBS3    IFR,LAB1
   564                                ENDM
   565                        IF_KEY_IRQ_FLAG MACRO   LAB1
   566                                BBS4    IFR,LAB1
   567                                ENDM
   568                        IF_EXT_IRQ_FLAG MACRO   LAB1
   569                                BBS5    IFR,LAB1
   570                                ENDM
   571                        IF_LCD_IRQ_FLAG MACRO   LAB1
   572                                BBS6    IFR,LAB1
   573                                ENDM
   574                        ;------------------------------------
   575                        LCD_ON           MACRO
   576                                SMB4    TMRC
   577                                ENDM
   578                        LCD_OFF          MACRO
   579                                RMB4    TMRC
   580                                ENDM
   581                        
   582                        PWM_ON  MACRO
   583                        		SMB0	SYSCLK	;Strong Mode
   584                                SMB7    TMRC
   585                                ENDM
   586                        PWM_OFF MACRO
   587                                RMB7    TMRC
   588                        ;		lda		R_Strong_2S
   589                        ;		bne		?Skip
   590                        		RMB0	SYSCLK	;WeakMode
   591                        ?Skip:
   592                                ENDM
   593                        ;DAC_ON		MACRO
   594                        ;	SMB7	P_TMRCTRL
   595                        ;	ENDM
   596                        ;DAC_OFF		MACRO
   597                        ;	RMB7	P_TMRCTRL
   598                        ;	ENDM
   599                        
   600                        IF_PWM_ON       MACRO   LAB
   601                                BBS7    TMRC,LAB
   602                                ENDM
   603                        IF_PWM_OFF      MACRO   LAB
   604                                BBR7    TMRC,LAB
   605                                ENDM
   606                        
   607                        SEL_PWM MACRO
   608                                SMB1    AUDCR
   609                                ENDM
   610                        DAC_LATCH_TMR0	MACRO
   611                        		SMB5	AUDCR
   612                        		ENDM
   613                        SEL_TONE MACRO
   614                                RMB2    AUDCR
   615                                RMB4    AUDCR
   616                                RMB5    AUDCR
   617                                ENDM
   618                        
   619                        SEL_MELODY  MACRO
   620                                RMB2    AUDCR
   621                                SMB4    AUDCR
   622                        ;        SMB5    AUDCR
   623                                RMB5    AUDCR
   624                                ENDM
   625                        SEL_VOICE   MACRO
   626                                SMB2    AUDCR
   627                                RMB4    AUDCR
   628                                SMB5    AUDCR
   629                                ENDM
   630                        ;------------------------------------
   631                        ClrAllRam MACRO
   632                            LDA		#$00
   633                        	LDX		#$FF
   634                        	STA		$1800
   635                        ?ClrAllRamLoop:
   636                        	STA		$1800,X
   637                        	DEX
   638                        	BNE		?ClrAllRamLoop
   639                            ENDM
   640                        ;------------------------------------
   641                        CHECK_LCD	MACRO
   642                        	LDA		#11111110B
   643                        	STA		P_PC_DIR		;PC0 is Output
   644                        	LDA		#11111110B
   645                        	STA		P_PC			;PC0 Output "0"
   646                        	NOP
   647                        	NOP
   648                        	NOP
   649                        	LDA		P_PC
   650                        	AND		#00000010B
   651                        ?_Loop
   652                        	STA		P_Temp+1
   653                        	LDA		#$0F
   654                        ?_LoopPort
   655                        	DEC
   656                        	BNE		?_LoopPort
   657                        	LDA		P_PC
   658                        	AND		#00000010B
   659                        	STA		P_Temp
   660                        	CMP		P_Temp+1
   661                        	BNE		?_Loop
   662                        	BBS1	P_Temp,?LCD_R_Type
   663                        ?LCD_C_Type:
   664                        	LCD_C_TYPE
   665                        	LCD_ENCH_EN
   666                        	LCD_5COM
   667                        	LCD_DRIVE_8
   668                        	LCD_C_1_3_BAIS_3V
   669                        	JMP		?Exit
   670                        ?LCD_R_Type:
   671                        	LCD_R_TYPE
   672                        ;	LCD_ENCH_EN
   673                        	LCD_5COM
   674                        ;	LCD_DRIVE_8
   675                        	LCD_R_1_3_BAIS
   676                        
   677                        ?Exit:
   678                        	LDA		#$00
   679                        	STA		P_PC_IO
   680                        	STA		P_PC
   681                        ;	STA		P_PC_IO_Backup
   682                        ;	STA		P_PC_Backup
   683                        	ENDM
   684                        ;------------------------------------
   685                        ;------------------------------------
   685                        
    23                        	.INCLUDE	MACRO.MAC
     1                        ;***********************************************************************
     2                        JMP_IDX MACRO	MEM
     3                        	if	MEM<$100
     4                        	JMP	($80+MEM)
     5                        	else
     6                        	JMP	(MEM)
     7                        	endif
     8                        	ENDM
     9                        
    10                        LDLN	MACRO	mem
    11                        	if	mem<$100
    12                        	LDA	$780+mem
    13                        	else
    14                        	LDA	$700+mem
    15                        	endif
    16                        	ENDM
    17                        
    18                        LDHN	MACRO	mem
    19                        	if	mem<$100
    20                        	LDA	$F80+mem
    21                        	else
    22                        	LDA	$F00+mem
    23                        	endif
    24                        	ENDM
    25                        
    26                        STLN	MACRO	mem
    27                        	if	mem<$100
    28                        	STA	$780+mem
    29                        	else
    30                        	STA	$700+mem
    31                        	endif
    32                        	ENDM
    33                        
    34                        STHN	MACRO	mem
    35                        	if	mem<$100
    36                        	STA	$F80+mem
    37                        	else
    38                        	STA	$F00+mem
    39                        	endif
    40                        	ENDM
    41                        
    42                        LXLN	MACRO	mem
    43                        	if	mem<$100
    44                        	LDX	$780+mem
    45                        	else
    46                        	LDX	$700+mem
    47                        	endif
    48                        	ENDM
    49                        
    50                        LXHN	MACRO	mem
    51                        	if	mem<$100
    52                        	LDX	$F80+mem
    53                        	else
    54                        	LDX	$F00+mem
    55                        	endif
    56                        	ENDM
    57                        
    58                        SXLN	MACRO	mem
    59                        	if	mem<$100
    60                        	STX	$780+mem
    61                        	else
    62                        	STX	$700+mem
    63                        	endif
    64                        	ENDM
    65                        
    66                        SXHN	MACRO	mem
    67                        	if	mem<$100
    68                        	STX	$F80+mem
    69                        	else
    70                        	STX	$F00+mem
    71                        	endif
    72                        	ENDM
    73                        
    74                        LDLN_X	MACRO	mem
    75                        	if	mem<$100
    76                        	LDA	$780+mem,X
    77                        	else
    78                        	LDA	$700+mem,X
    79                        	endif
    80                        	ENDM
    81                        
    82                        STLN_X	MACRO	mem
    83                        	if	mem<$100
    84                        	STA	$780+mem,X
    85                        	else
    86                        	STA	$700+mem,X
    87                        	endif
    88                        	ENDM
    89                        
    90                        LDHN_X	MACRO	mem
    91                        	if	mem<$100
    92                        	LDA	$F80+mem,X
    93                        	else
    94                        	LDA	$F00+mem,X
    95                        	endif
    96                        	ENDM
    97                        
    98                        STHN_X	MACRO	mem
    99                        	if	mem<$100
   100                        	STA	$F80+mem,X
   101                        	else
   102                        	STA	$F00+mem,X
   103                        	endif
   104                        	ENDM
   105                        
   106                        INCHN_X	MACRO	mem
   107                        	if	mem<$100
   108                        	INC	$F80+mem,X
   109                        	else
   110                        	INC	$F00+mem,X
   111                        	endif
   112                        	ENDM
   113                        
   114                        DECHN_X	MACRO	mem
   115                        	if	mem<$100
   116                        	DEC	$F80+mem,X
   117                        	else
   118                        	DEC	$F00+mem,X
   119                        	endif
   120                        	ENDM
   121                        
   122                        ADCLN	MACRO	mem
   123                        	if	mem<$100
   124                        	ADC	$780+mem
   125                        	else
   126                        	ADC	$700+mem
   127                        	endif
   128                        	ENDM
   129                        
   130                        ADCHN	MACRO	mem
   131                        	if	mem<$100
   132                        	ADC	$F80+mem
   133                        	else
   134                        	ADC	$F00+mem
   135                        	endif
   136                        	ENDM
   137                        
   138                        CMPLN	MACRO	mem
   139                        	if	mem<$100
   140                        	CMP	$780+mem
   141                        	else
   142                        	CMP	$700+mem
   143                        	endif
   144                        	ENDM
   145                        
   146                        CMPHN	MACRO	mem
   147                        	if	mem<$100
   148                        	CMP	$F80+mem
   149                        	else
   150                        	CMP	$F00+mem
   151                        	endif
   152                        	ENDM
   153                        
   154                        INCLN	MACRO	mem
   155                        	if	mem<$100
   156                        	INC	$780+mem
   157                        	else
   158                        	INC	$700+mem
   159                        	endif
   160                        	ENDM
   161                        
   162                        INCHN	MACRO	mem
   163                        	if	mem<$100
   164                        	INC	$F80+mem
   165                        	else
   166                        	INC	$F00+mem
   167                        	endif
   168                        	ENDM
   169                        
   170                        DECLN	MACRO	mem
   171                        	if	mem<$100
   172                        	DEC	$780+mem
   173                        	else
   174                        	DEC	$700+mem
   175                        	endif
   176                        	ENDM
   177                        
   178                        DECHN	MACRO	mem
   179                        	if	mem<$100
   180                        	DEC	$F80+mem
   181                        	else
   182                        	DEC	$F00+mem
   183                        	endif
   184                        	ENDM
   185                        
   186                        LDA_X	MACRO	mem
   187                        	if	mem<$100
   188                        	LDA	$80+mem,X
   189                        	else
   190                        	LDA	mem,X
   191                        	endif
   192                        	ENDM
   193                        
   194                        STA_X	MACRO	mem
   195                        	if	mem<$100
   196                        	STA	$80+mem,X
   197                        	else
   198                        	STA	mem,X
   199                        	endif
   200                        	ENDM
   201                        
   202                        STZ_X	MACRO	mem
   203                        	if	mem<$100
   204                        	STZ	$80+mem,X
   205                        	else
   206                        	STZ	mem,X
   207                        	endif
   208                        	ENDM
   209                        
   210                        INC_X	MACRO	mem
   211                        	if	mem<$100
   212                        	INC	$80+mem,X
   213                        	else
   214                        	INC	mem,X
   215                        	endif
   216                        	ENDM
   217                        
   218                        ADC_X	MACRO	mem
   219                        	if	mem<$100
   220                        	ADC	$80+mem,X
   221                        	else
   222                        	ADC	mem,X
   223                        	endif
   224                        	ENDM
   225                        
   226                        SBC_X	MACRO	mem
   227                        	if	mem<$100
   228                        	SBC	$80+mem,X
   229                        	else
   230                        	SBC	mem,X
   231                        	endif
   232                        	ENDM
   233                        
   234                        CMP_X	MACRO	mem
   235                        	if	mem<$100
   236                        	CMP	$80+mem,X
   237                        	else
   238                        	CMP	mem,X
   239                        	endif
   240                        	ENDM
   241                        
   242                        ASLLN	MACRO	mem
   243                        	if	mem<$100
   244                        	ASL	$780+mem
   245                        	else
   246                        	ASL	$700+mem
   247                        	endif
   248                        	ENDM
   249                        
   250                        LSRLN	MACRO	mem
   251                        	if	mem<$100
   252                        	LSR	$780+mem
   253                        	else
   254                        	LSR	$700+mem
   255                        	endif
   256                        	ENDM
   257                        
   258                        ROLLN	MACRO	mem
   259                        	if	mem<$100
   260                        	ROL	$780+mem
   261                        	else
   262                        	ROL	$700+mem
   263                        	endif
   264                        	ENDM
   265                        
   266                        RORLN	MACRO	mem
   267                        	if	mem<$100
   268                        	ROR	$780+mem
   269                        	else
   270                        	ROR	$700+mem
   271                        	endif
   272                        	ENDM
   273                        
   274                        ASLHN	MACRO	mem
   275                        	if	mem<$100
   276                        	ASL	$F80+mem
   277                        	else
   278                        	ASL	$F00+mem
   279                        	endif
   280                        	ENDM
   281                        
   282                        LSRHN	MACRO	mem
   283                        	if	mem<$100
   284                        	LSR	$F80+mem
   285                        	else
   286                        	LSR	$F00+mem
   287                        	endif
   288                        	ENDM
   289                        
   290                        ROLHN	MACRO	mem
   291                        	if	mem<$100
   292                        	ROL	$F80+mem
   293                        	else
   294                        	ROL	$F00+mem
   295                        	endif
   296                        	ENDM
   297                        
   298                        RORHN	MACRO	mem
   299                        	if	mem<$100
   300                        	ROR	$F80+mem
   301                        	else
   302                        	ROR	$F00+mem
   303                        	endif
   304                        	ENDM
   305                        
   306                        
   307                        BR0	MACRO	PARA,VAR,LABLE
   308                        	BBR@<VAR.mod.8> PARA,LABLE
   309                        	ENDM
   310                        
   311                        BR1	MACRO	PARA,VAR,LABLE
   312                        	BBS@<VAR.mod.8>	PARA,LABLE
   313                        	ENDM
   314                        
   315                        xSETB	MACRO	flag,bit
   316                        	SMB@<bit>  flag
   317                        	ENDM
   318                        
   319                        xCLRB	MACRO	flag,bit
   320                        	RMB@<bit>  flag
   321                        	ENDM
   322                        
   323                        ;CHECK_LCD	MACRO
   324                        ;	LDA		#00001110B
   325                        ;	STA		P_PC_DIR		;PC0 is Output
   326                        ;	LDA		#11111110B
   327                        ;	STA		P_PC			;PC0 Output "0"
   328                        ;	NOP
   329                        ;	NOP
   330                        ;	NOP
   331                        ;	LDA		P_PC
   332                        ;	AND		#00000010B
   333                        ;?_Loop
   334                        ;	STA		P_Temp+1
   335                        ;	LDA		#$0F
   336                        ;?_LoopPort
   337                        ;	DEC
   338                        ;	BNE		?_LoopPort
   339                        ;	LDA		P_PC
   340                        ;	AND		#00000010B
   341                        ;	STA		P_Temp
   342                        ;	CMP		P_Temp+1
   343                        ;	BNE		?_Loop
   344                        ;	BBS1	P_Temp,LCD_R_Type
   345                        ;LCD_C_Type:
   346                        ;	LDA		#10000000B
   347                        ;	STA		P_LCD_COM	;LCD选择C-Type,4COM,34SEG,1/3Bais
   348                        ;	BRA		L_PC_Init
   349                        ;LCD_R_Type:
   350                        ;	LDA		#0
   351                        ;	STA		P_LCD_COM	;LCD选择R-Type,4COM,34SEG,1/4Bais
   352                        ;L_PC_Init:
   353                        ;	LDA		#00001111B
   354                        ;	STA		P_PC_DIR
   355                        ;	LDA		#11111111B
   356                        ;	STA		P_PC		;PC4,5,6,7输入上拉。
   357                        ;	ENDM
   358                        
   359                        
   360                        ;	LDA		#11111110B
   361                        ;	STA		P_PC		;PC0 Output "0"
   362                        ;	STA		P_PC_DIR		;PC0 is Output
   363                        ;	LDA		P_PC
   364                        ;	AND		#00000010B
   365                        ;?_Loop
   366                        ;	STA		P_Temp+1
   367                        ;	LDA		#$0F
   368                        ;?_LoopPort
   369                        ;	DEC
   370                        ;	BNE		?_LoopPort
   371                        ;	LDA		P_PC
   372                        ;	AND		#00000010B
   373                        ;	STA		P_Temp
   374                        ;	CMP		P_Temp+1
   375                        ;	BNE		?_Loop
   376                        ;	LDA		#$FF
   377                        ;	STA		P_PC
   378                        ;	STA		P_PC_DIR
   379                        ;	BBS1	P_Temp,LCD_R_Type
   380                        ;LCD_C_Type:
   381                        ;	LDA		#00110000B
   382                        ;	STA		P_PCSEG		;定义PC4~PC7为Seg
   383                        ;	LDA		#10000000B
   384                        ;	STA		P_LCD_COM	;LCD选择C-Type,4COM,34SEG,1/3Bias
   385                        ;	BRA		LCD_CR_Type
   386                        ;LCD_R_Type:
   387                        ;	LDA		#00110000B
   388                        ;	STA		P_PCSEG		;定义PC4~PC7为Seg
   389                        ;	STZ		P_LCD_COM	;LCD选择R-Type,4COM,34SEG,1/4Bias
   390                        
   390                        
    24                        ;***************************************
    25                        STACK_BOT		EQU		FFH						;堆栈底部
    26                        ;***************************************
    27                        	.PROG										;程序开始
    28                        V_RESET:
    29 00:F000: 1A            	NOP
    30 00:F001: 1A            	NOP
    31 00:F002: 1A            	NOP
    32 00:F003: 5E FF         	LDX		#STACK_BOT
    33 00:F005: 1E            	TXS											; 使用这个值初始化堆栈指针，这通常是为了设置堆栈的底部地址，确保程序运行中堆栈的正确使用。
    34 00:F006: 53 B7         	LDA		#$B7								; #$07
    35 00:F008: 7F 1D         	STA		SYSCLK								; 设置系统时钟
    36                        	ClrAllRam									; 清RAM
+   36 00:F00A: 53 00          LDA #$0000
+   36 00:F00C: 5E FF          LDX #$00FF
+   36 00:F00E: 4F 00 18       STA $1800
+   36                        ?ClrAllRamLoop:
+   36 00:F011: 6F 00 18       STA $1800,X
+   36 00:F014: 0F             DEX
+   36 00:F015: 12 FA          BNE ?ClrAllRamLoop
    37 00:F017: 53 00         	LDA		#0
    38 00:F019: 7F 18         	STA		DIVC								; 分频控制器，定时器与DICV异步
    39 00:F01B: 7F 0E         	STA		IER									; 除能中断
    40 00:F01D: 7F 0F         	STA		IFR									; 初始化中断标志位
    41 00:F01F: 7F 05         	STA		PB
    42 00:F021: 73 3E         	LDA		FUSE
    43 00:F023: 7F 2F         	STA		MF									;为内部RC振荡器提供校准数据
    44                        
    45 00:F025: 15 25 F4      	jsr		F_Beep_Init
    46 00:F028: 15 63 F3      	jsr		L_Init_SystemRam_Prog				;初始化系统RAM并禁用所有断电保留的RAM
    47                        
    48 00:F02B: 15 84 F3      	jsr		F_LCD_Init
    49 00:F02E: 15 EB F3      	jsr		F_Port_Init
    50                        
    51 00:F031: 53 07         	lda		#$07								;系统时钟和中断使能
    52 00:F033: 7F 1D         	sta		SYSCLK
    53                        
    54 00:F035: 15 00 F4      	jsr		F_Timer_Init
    55 00:F038: 15 A5 F7      	jsr		F_Display_Time
    56                        
    57 00:F03B: 05            	cli		; 开总中断
    58                        
    59                        	; test Code
    60                        
    61                        ;***********************************************************************
    62                        ;***********************************************************************
    63                        MainLoop:
    64                        main:
    65 00:F03C: 73 AB         	lda		Timer_Flag							; 判断是否需要响铃
    66 00:F03E: 51 0C         	and		#$0c
    67 00:F040: 56 00         	cmp		#$00
    68 00:F042: 13 03         	beq		Beep_Out
    69 00:F044: 15 3F F3      	jsr		F_Beep_Manage
    70                        
    71                        Beep_Out:
    72 00:F047: 39 AD 16      	bbs1	Key_Flag,Key_QA_Out					; 首次触发必定进扫键
    73 00:F04A: 36 AB 1B      	bbr6	Timer_Flag,Key_Out					; 必须有4Hz计时标志才能进扫键
    74 00:F04D: 26 AB         	rmb6	Timer_Flag							; 清4Hz标志
    75 00:F04F: 3C AB 0E      	bbs4	Timer_Flag,Key_QA_Out
    76 00:F052: 78 A5         	inc		Counter_1Hz
    77 00:F054: 73 A5         	lda		Counter_1Hz
    78 00:F056: 56 08         	cmp		#$8
    79 00:F058: 10 06         	bcc		Key_QA_Out
    80 00:F05A: 53 00         	lda		#$0
    81 00:F05C: 7F A5         	sta		Counter_1Hz
    82 00:F05E: 2C AB         	smb4	Timer_Flag							; 长按1s就给快加标志
    83                        
    84                        Key_QA_Out:
    85 00:F060: 28 AD         	smb0	Key_Flag							; 扫键标志位
    86                        
    87                        Key_Flag_Out:
    88 00:F062: 30 AD 03      	bbr0	Key_Flag,Key_Out
    89 00:F065: 15 EB F0      	jsr		F_Key_Trigger						; 有按键按下和长按延时到了才扫键
    90                        
    91                        Key_Out:
    92                        	; 判断处于那种状态，并进入对应状态的处理
    93 00:F068: 38 AC 09      	bbs0	Sys_Status_Flag, Status_Init
    94 00:F06B: 3B AC 18      	bbs3	Sys_Status_Flag, Status_Pause
    95 00:F06E: 39 AC 05      	bbs1	Sys_Status_Flag, Status_Pos
    96 00:F071: 3A AC 0D      	bbs2	Sys_Status_Flag, Status_Des
    97                        
    98                        Status_Init:
    99                        
   100 00:F074: 17 C6         	bra		MainLoop
   101                        Status_Pos:
   102 00:F076: 15 C6 F1      	jsr		F_Sec_Pos_Counter
   103 00:F079: 31 AB C0      	bbr1	Timer_Flag,MainLoop
   104 00:F07C: 15 4A F2      	jsr		Pos_Time_Count
   105 00:F07F: 17 BB         	bra		MainLoop
   106                        Status_Des:
   107 00:F081: 15 86 F2      	jsr		F_Sec_Des_Counter
   108 00:F084: 17 B6         	bra		MainLoop
   109                        Status_Pause:
   110                        
   111 00:F086: 17 B4         	bra		MainLoop
   112                        
   113                        
   114                        
   115                        ;***********************************************************************
   116                        ;***********************************************************************
   117                        V_IRQ:
   118 00:F088: 0A            	PHA
   119 00:F089: 73 0E         	LDA		P_IER
   120 00:F08B: 71 0F         	AND		P_IFR
   121 00:F08D: 7F A4         	STA		R_Int_Backup
   122                        
   123 00:F08F: 3E A4 45      	BBS6	R_Int_Backup,L_LcdIrq
   124 00:F092: 3B A4 12      	BBS3	R_Int_Backup,L_Timer2Irq
   125 00:F095: 3C A4 31      	BBS4	R_Int_Backup,L_PaIrp
   126 00:F098: 38 A4 08      	BBS0	R_Int_Backup,L_DivIrq
   127 00:F09B: 3A A4 25      	BBS2	R_Int_Backup,L_Timer1Irq
   128 00:F09E: 39 A4 0E      	BBS1	R_Int_Backup,L_Timer0Irq
   129 00:F0A1: 17 46         	BRA		L_EndIrq
   130                        
   131                        L_DivIrq:
   132                        	CLR_DIV_IRQ_FLAG
+  132 00:F0A3: 20 0F          RMB0 IFR
   133 00:F0A5: 17 42         	BRA		L_EndIrq
   134                        
   135                        L_Timer2Irq:
   136                        	CLR_TMR2_IRQ_FLAG
+  136 00:F0A7: 23 0F          RMB3 IFR
   137 00:F0A9: 28 AB         	smb0	Timer_Flag							; 半秒标志，定时器本身是1秒
   138 00:F0AB: 29 AB         	smb1	Timer_Flag							; 走时标志，第一次进计数子程序需要走时
   139 00:F0AD: 17 3A         	bra		L_EndIrq							; 下半秒由动画完成时定义
   140                        
   141                        L_Timer0Irq:
   142                        	CLR_TMR0_IRQ_FLAG
+  142 00:F0AF: 21 0F          RMB1 IFR
   143 00:F0B1: 73 A7         	lda		Counter_16Hz						; 帧计时
   144 00:F0B3: 56 04         	cmp		#4
   145 00:F0B5: 10 08         	bcc		L_16Hz_Count_Out
   146 00:F0B7: 53 00         	lda		#0
   147 00:F0B9: 7F A7         	sta		Counter_16Hz
   148 00:F0BB: 2F AB         	smb7	Timer_Flag
   149 00:F0BD: 17 2A         	bra		L_EndIrq
   150                        L_16Hz_Count_Out:
   151 00:F0BF: 78 A7         	inc		Counter_16Hz
   152 00:F0C1: 17 26         	BRA		L_EndIrq
   153                        
   154                        L_Timer1Irq:
   155                        	CLR_TMR1_IRQ_FLAG
+  155 00:F0C3: 22 0F          RMB2 IFR
   156 00:F0C5: 2D AB         	smb5	Timer_Flag
   157 00:F0C7: 17 20         	BRA		L_EndIrq
   158                        
   159                        L_PaIrp:
   160                        	CLR_KEY_IRQ_FLAG
+  160 00:F0C9: 24 0F          RMB4 IFR
   161                        
   162 00:F0CB: 28 AD         	smb0	Key_Flag
   163 00:F0CD: 29 AD         	smb1	Key_Flag							; 首次触发
   164 00:F0CF: 24 AB         	rmb4	Timer_Flag							; 快加标志位
   165 00:F0D1: 26 AB         	rmb6	Timer_Flag
   166                        
   167                        	EN_LCD_IRQ
+  167 00:F0D3: 2E 0E          SMB6 IER
   168                        
   169 00:F0D5: 17 12         	BRA		L_EndIrq
   170                        
   171                        L_LcdIrq:
   172                        	CLR_LCD_IRQ_FLAG
+  172 00:F0D7: 26 0F          RMB6 IFR
   173 00:F0D9: 73 A6         	lda		Counter_4Hz
   174 00:F0DB: 56 04         	cmp		#$4
   175 00:F0DD: 10 08         	bcc		L_LCD_4Hz_Out
   176 00:F0DF: 53 00         	lda		#$0
   177 00:F0E1: 7F A6         	sta		Counter_4Hz
   178 00:F0E3: 2E AB         	smb6	Timer_Flag
   179 00:F0E5: 17 02         	bra		L_EndIrq
   180                        L_LCD_4Hz_Out:
   181 00:F0E7: 78 A6         	inc		Counter_4Hz
   182                        
   183                        L_EndIrq:
   184                        ;	BBS3	IFR,L_Timer2Irq
   185 00:F0E9: 0C            	PLA
   186 00:F0EA: 08            	RTI
   187                        
   188                        
   189                        ;***********************************************************************
   190                        .INCLUDE	ScanKey.asm
     1                        F_Key_Trigger:
     2 00:F0EB: 3C AB 25      	bbs4	Timer_Flag,L_Quik_Add_1
     3 00:F0EE: 20 AD         	rmb0	Key_Flag
     4 00:F0F0: 31 AD 16      	bbr1	Key_Flag,L_Key_Wait					; 首次按键触发才需要消抖
     5 00:F0F3: 21 AD         	rmb1	Key_Flag							; 清除首次按键触发
     6 00:F0F5: 53 00         	LDA		#$00
     7 00:F0F7: 7F B6         	STA		P_Temp
     8                        L_Delay_Trigger:								; 消抖延时循环用标签
     9 00:F0F9: 78 B6         	inc		P_Temp
    10 00:F0FB: 73 B6         	lda		P_Temp
    11 00:F0FD: 12 FA         	bne		L_Delay_Trigger						; 软件消抖
    12                        
    13                        L_Key_Beep:
    14 00:F0FF: 53 02         	lda		#$02								; 设置按键提示音的响铃序列
    15 00:F101: 7F AA         	sta		Beep_Serial
    16 00:F103: 53 EF         	lda		#$ef
    17 00:F105: 7F 12         	sta		TMR1
    18 00:F107: 17 0A         	bra		L_Quik_Add_1
    19                        
    20                        L_Key_Wait:
    21 00:F109: 73 01         	lda		P_PA								; 长按时，在快加到来前，只需要判断有效按键是否存在
    22 00:F10B: 51 A4         	and		#$a4								; 并关闭中断
    23 00:F10D: 56 00         	cmp		#$0
    24 00:F10F: 13 19         	beq		L_Quik_Add_2
    25 00:F111: 12 21         	bne		L_Key_rts
    26                        
    27                        L_Quik_Add_1:
    28 00:F113: 73 01         	lda		P_PA								; 判断4种按键触发情况
    29 00:F115: 51 A4         	and		#$A4
    30 00:F117: 56 04         	cmp		#$04
    31 00:F119: 13 1A         	beq		L_KeyM_Trigger						; M单独触发
    32 00:F11B: 56 20         	cmp		#$20
    33 00:F11D: 13 37         	beq		L_KeyS_Trigger						; S单独触发
    34 00:F11F: 3C AB 08      	bbs4	Timer_Flag,L_Quik_Add_2				; C触发和ms触发不需要快加
    35 00:F122: 56 80         	cmp		#$80
    36 00:F124: 13 51         	beq		L_KeyC_Trigger						; C单独触发
    37 00:F126: 56 24         	cmp		#$24
    38 00:F128: 13 77         	beq		L_KeyMS_Trigger						; M、S同时触发
    39                        
    40                        L_Quik_Add_2:
    41                        	DIS_LCD_IRQ
+   41 00:F12A: 26 0E          RMB6 IER
    42 00:F12C: 24 AB         	rmb4	Timer_Flag							; 若无有效按键组合，则清掉快加标志位
    43 00:F12E: 26 AB         	rmb6	Timer_Flag
    44 00:F130: 53 00         	lda		#$0
    45 00:F132: 7F A6         	sta		Counter_4Hz							; 非以上四种情况则属无效按键触发
    46                        
    47                        L_Key_rts:
    48 00:F134: 09            	rts
    49                        
    50                        
    51                        L_KeyM_Trigger:
    52 00:F135: 2A AB         	smb2	Timer_Flag							; 按键提示音
    53                        	; 处理正、倒计时态的情况，若是这两种状态，则按键触发无效
    54 00:F137: 3B AC 04      	bbs3	Sys_Status_Flag,L_KeyM_Pause		; 若非暂停态或初始态，则状态不会改变
    55 00:F13A: 38 AC 01      	bbs0	Sys_Status_Flag,L_KeyM_Pause
    56 00:F13D: 09            	rts
    57                        	; 处理初始态和暂停态的情况
    58                        L_KeyM_Pause:
    59 00:F13E: 53 0C         	lda		#1100B
    60 00:F140: 7F AC         	sta		Sys_Status_Flag
    61 00:F142: 78 B5         	inc		R_Time_Min
    62 00:F144: 73 B5         	lda		R_Time_Min
    63 00:F146: 56 64         	cmp		#100
    64 00:F148: 13 04         	beq		L_Reset_Min
    65 00:F14A: 15 C7 F7      	jsr		L_DisTimer_Min
    66 00:F14D: 09            	rts
    67                        
    68                        L_Reset_Min:
    69 00:F14E: 53 00         	lda		#$0
    70 00:F150: 7F B5         	sta		R_Time_Min
    71 00:F152: 15 C7 F7      	jsr		L_DisTimer_Min
    72 00:F155: 09            	rts
    73                        
    74                        
    75                        L_KeyS_Trigger:
    76 00:F156: 2A AB         	smb2	Timer_Flag							; 按键提示音
    77                        	; 处理正、倒计时态的情况，若是这两种状态，则按键触发无效
    78 00:F158: 3B AC 04      	bbs3	Sys_Status_Flag,L_KeyS_Pause		; 若非暂停态或初始态，则状态不会改变
    79 00:F15B: 38 AC 01      	bbs0	Sys_Status_Flag,L_KeyS_Pause
    80 00:F15E: 09            	rts
    81                        	; 处理初始态和暂停态的情况
    82                        L_KeyS_Pause:
    83 00:F15F: 53 0C         	lda		#1100B
    84 00:F161: 7F AC         	sta		Sys_Status_Flag						; 切换为倒计时暂停态
    85                        
    86 00:F163: 78 B4         	inc		R_Time_Sec
    87 00:F165: 73 B4         	lda		R_Time_Sec
    88 00:F167: 56 3C         	cmp		#60
    89 00:F169: 13 04         	beq		L_Reset_Sec
    90 00:F16B: 15 AF F7      	jsr		L_DisTimer_Sec
    91 00:F16E: 09            	rts
    92                        
    93                        L_Reset_Sec:									; 60溢出后回到0
    94 00:F16F: 53 00         	lda		#$0
    95 00:F171: 7F B4         	sta		R_Time_Sec
    96 00:F173: 15 AF F7      	jsr		L_DisTimer_Sec
    97 00:F176: 09            	rts
    98                        
    99                        
   100                        L_KeyC_Trigger:
   101 00:F177: 2A AB         	smb2	Timer_Flag							; 按键提示音
   102                        
   103 00:F179: 73 AC         	lda		Sys_Status_Flag						; 处于正、倒计时态，需转为对应暂停态
   104 00:F17B: 56 02         	cmp		#$02
   105 00:F17D: 13 0E         	beq		L_KeyC_PosDes
   106 00:F17F: 56 04         	cmp		#$04
   107 00:F181: 13 0A         	beq		L_KeyC_PosDes
   108                        
   109 00:F183: 3B AC 0E      	bbs3	Sys_Status_Flag,L_KeyC_Pause		; 处于正、倒计时暂停态，需转为对应计时态
   110                        	; 处理初始态的情况
   111 00:F186: 53 02         	lda		#$02								; 进入正计时态
   112 00:F188: 7F AC         	sta		Sys_Status_Flag
   113                        	TMR2_ON
+  113 00:F18A: 2A 16          SMB2 TMRC
   114 00:F18C: 09            	rts
   115                        
   116                        	; 处理正倒计时中的情况
   117                        L_KeyC_PosDes:
   118 00:F18D: 2B AC         	smb3	Sys_Status_Flag						; 进入正、倒计时暂停态
   119                        	TMR2_OFF									; 关掉半S计时
+  119 00:F18F: 22 16          RMB2 TMRC
   120                        	TMR0_OFF
+  120 00:F191: 20 16          RMB0 TMRC
   121 00:F193: 09            	rts
   122                        
   123                        	; 处理暂停态的情况
   124                        L_KeyC_Pause:
   125 00:F194: 23 AC         	rmb3	Sys_Status_Flag						; 退出暂停态
   126 00:F196: 15 B9 F1      	jsr		Init_Frame_Count					; 初始化FrameCount
   127 00:F199: 15 A5 F7      	jsr		F_Display_Time
   128                        	TMR2_ON										; 重新启动半S计时
+  128 00:F19C: 2A 16          SMB2 TMRC
   129                        	TMR0_ON
+  129 00:F19E: 28 16          SMB0 TMRC
   130 00:F1A0: 09            	rts
   131                        
   132                        
   133                        L_KeyMS_Trigger:
   134 00:F1A1: 53 00         	lda		#$0									; 回到初始态，全部清零
   135 00:F1A3: 7F B4         	sta		R_Time_Sec
   136 00:F1A5: 7F B5         	sta		R_Time_Min
   137 00:F1A7: 7F AD         	sta		Key_Flag
   138 00:F1A9: 7F AC         	sta		Sys_Status_Flag
   139 00:F1AB: 28 AC         	smb0	Sys_Status_Flag
   140 00:F1AD: 7F 14         	sta		TMR2								; 关闭半秒计时，并清空寄存器
   141                        	TMR2_OFF
+  141 00:F1AF: 22 16          RMB2 TMRC
   142                        	TMR0_OFF
+  142 00:F1B1: 20 16          RMB0 TMRC
   143                        
   144 00:F1B3: 2A AB         	smb2	Timer_Flag							; 按键提示音标志位
   145 00:F1B5: 15 A5 F7      	jsr		F_Display_Time
   146 00:F1B8: 09            	rts
   147                        
   148                        Init_Frame_Count:
   149 00:F1B9: 39 AC 05      	bbs1	Sys_Status_Flag, Pos_Frame_Count
   150 00:F1BC: 53 08         	lda		#$08
   151 00:F1BE: 7F A9         	sta		Frame_Counter
   152 00:F1C0: 09            	rts
   153                        Pos_Frame_Count:
   154 00:F1C1: 53 00         	lda		#$0
   155 00:F1C3: 7F A9         	sta		Frame_Counter
   156 00:F1C5: 09            	rts
   156                        
   191                        .INCLUDE	Time.asm
     1                        F_Sec_Pos_Counter:
     2 00:F1C6: 73 AB         	lda		Timer_Flag
     3 00:F1C8: 51 81         	and		#$81							; 半秒和16hz计时必须有一个为1
     4 00:F1CA: 56 80         	cmp		#$80
     5 00:F1CC: 12 34         	bne		L_Sec_Pos_rts
     6 00:F1CE: 27 AB         	rmb7	Timer_Flag
     7                        
     8 00:F1D0: 78 A9         	inc		Frame_Counter
     9                        
    10 00:F1D2: 73 B4         	lda		R_Time_Sec
    11 00:F1D4: 56 3C         	cmp		#60
    12 00:F1D6: 13 2B         	beq		L_CarryToMin					; 秒进位分动画
    13                        
    14 00:F1D8: 15 E1 F7      	jsr		F_DisFrame_Sec_d4				; sec个位走时动画
    15                        
    16 00:F1DB: 73 B4         	lda		R_Time_Sec						; 检测十位有没有进位
    17 00:F1DD: 15 74 F2      	jsr		F_DivideBy10					; 除以10的结果不为零，且余数为0才执行十位的动画
    18 00:F1E0: 56 00         	cmp		#0								; 商为0则一定无十位，d3无动画
    19 00:F1E2: 13 09         	beq		L_Sec_D3_Out
    20 00:F1E4: 73 B6         	lda		P_Temp							; 余数不为0也不更新十位
    21 00:F1E6: 56 00         	cmp		#0
    22 00:F1E8: 12 03         	bne		L_Sec_D3_Out
    23                        
    24 00:F1EA: 15 FA F7      	jsr		F_DisFrame_Sec_d3				; sec十位走时动画
    25                        
    26                        L_Sec_D3_Out:
    27 00:F1ED: 73 A9         	lda		Frame_Counter
    28 00:F1EF: 56 08         	cmp		#$08
    29 00:F1F1: 13 06         	beq		L_Sec_Pos_Out
    30                        
    31 00:F1F3: 5E 54         	ldx		#lcd_MS
    32 00:F1F5: 15 BB F4      	jsr		F_ClrpSymbol
    33                        
    34 00:F1F8: 09            	rts
    35                        
    36                        L_Sec_Pos_Out:
    37 00:F1F9: 5E 54         	ldx		#lcd_MS
    38 00:F1FB: 15 B4 F4      	jsr		F_DispSymbol
    39 00:F1FE: 53 00         	lda		#0
    40 00:F200: 7F A9         	sta		Frame_Counter
    41                        
    42                        L_Sec_Pos_rts:
    43 00:F202: 09            	rts
    44                        
    45                        L_CarryToMin:
    46 00:F203: 73 B5         	lda		R_Time_Min
    47 00:F205: 56 64         	cmp		#100
    48 00:F207: 13 31         	beq		L_Time_Overflow					; 计满99min59s则为溢出
    49                        
    50 00:F209: 15 E1 F7      	jsr		F_DisFrame_Sec_d4				; Sec个位走时动画
    51 00:F20C: 15 FA F7      	jsr		F_DisFrame_Sec_d3				; Sec十位走时动画
    52 00:F20F: 15 16 F8      	jsr		F_DisFrame_Min_d2				; Min个位走时动画
    53                        
    54 00:F212: 73 B5         	lda		R_Time_Min						; 检测十位有没有进位
    55 00:F214: 15 74 F2      	jsr		F_DivideBy10					; 除以10的结果不为零，且余数为0才执行十位的动画
    56 00:F217: 56 00         	cmp		#0								; 商为0则一定无十位，d3无动画
    57 00:F219: 13 09         	beq		L_Min_D1_Out
    58 00:F21B: 73 B6         	lda		P_Temp							; 余数不为0也不更新十位
    59 00:F21D: 56 00         	cmp		#0
    60 00:F21F: 12 03         	bne		L_Min_D1_Out
    61                        
    62 00:F221: 15 2B F8      	jsr		F_DisFrame_Min_d1				; Min十位走时动画
    63                        
    64                        L_Min_D1_Out:
    65 00:F224: 73 A9         	lda		Frame_Counter
    66 00:F226: 56 08         	cmp		#$08
    67 00:F228: 13 06         	beq		L_Min_Pos_Out
    68 00:F22A: 5E 54         	ldx		#lcd_MS
    69 00:F22C: 15 BB F4      	jsr		F_ClrpSymbol
    70 00:F22F: 09            	rts
    71                        
    72                        L_Min_Pos_Out:
    73 00:F230: 5E 54         	ldx		#lcd_MS
    74 00:F232: 15 B4 F4      	jsr		F_DispSymbol
    75 00:F235: 53 00         	lda		#0
    76 00:F237: 7F A9         	sta		Frame_Counter
    77 00:F239: 09            	rts
    78                        
    79                        L_Time_Overflow:
    80 00:F23A: 53 0C         	lda		#$0c							; 正计时溢出则进入倒计时暂停态
    81 00:F23C: 7F AC         	sta		Sys_Status_Flag
    82 00:F23E: 53 63         	lda		#99
    83 00:F240: 7F B5         	sta		R_Time_Min
    84 00:F242: 53 3B         	lda		#59
    85 00:F244: 7F B4         	sta		R_Time_Sec
    86 00:F246: 15 A5 F7      	jsr		F_Display_Time
    87 00:F249: 09            	rts
    88                        
    89                        ; 增时独立于动画显示进行
    90                        Pos_Time_Count:
    91 00:F24A: 21 AB         	rmb1	Timer_Flag
    92 00:F24C: 73 B4         	lda		R_Time_Sec
    93 00:F24E: 56 3B         	cmp		#59
    94 00:F250: 13 12         	beq		Count_Add_Min
    95 00:F252: 56 3C         	cmp		#60
    96 00:F254: 13 03         	beq		Count_CarryToMin				; 秒数满则进位分钟数
    97 00:F256: 78 B4         	inc		R_Time_Sec
    98 00:F258: 09            	rts
    99                        Count_CarryToMin:
   100 00:F259: 73 B5         	lda		R_Time_Min
   101 00:F25B: 56 63         	cmp		#99
   102 00:F25D: 13 0A         	beq		Count_Overflow
   103 00:F25F: 53 01         	lda		#$1
   104 00:F261: 7F B4         	sta		R_Time_Sec
   105 00:F263: 09            	rts
   106                        Count_Add_Min:
   107 00:F264: 78 B4         	inc		R_Time_Sec
   108 00:F266: 78 B5         	inc		R_Time_Min
   109 00:F268: 09            	rts
   110                        Count_Overflow:
   111 00:F269: 53 00         	lda		#$0
   112 00:F26B: 7F B4         	sta		R_Time_Sec
   113 00:F26D: 7F B5         	sta		R_Time_Min
   114                        	TMR2_OFF
+  114 00:F26F: 22 16          RMB2 TMRC
   115                        	TMR0_OFF
+  115 00:F271: 20 16          RMB0 TMRC
   116 00:F273: 09            	rts
   117                        
   118                        
   119                        F_DivideBy10:
   120 00:F274: 5E 00         	ldx		#0								; 初始化 X 寄存器为 0，保存商
   121 00:F276: 7F B6         	sta		P_Temp							; 临时保存余数
   122                        DivideBy10:
   123 00:F278: 56 0A         	cmp		#10								; 检查 A 是否大于等于 10
   124 00:F27A: 10 06         	bcc		Done							; 如果 A 小于 10，跳转到 Done
   125 00:F27C: 00            	sec										; 设置进位，准备减法
   126 00:F27D: 55 0A         	sbc		#10								; A = A - 10
   127 00:F27F: 0B            	inx										; X = X + 1，记录商
   128 00:F280: 17 F6         	bra		DivideBy10						; 如果没有借位，继续循环
   129                        Done:
   130 00:F282: 7F B6         	sta		P_Temp							; 剩余值(余数)
   131 00:F284: 1C            	txa
   132 00:F285: 09            	rts
   133                        
   134                        
   135                        
   136                        
   137                        
   138                        
   139                        ; 倒计时部分
   140                        F_Sec_Des_Counter:
   141 00:F286: 38 AB 01      	bbs0	Timer_Flag, Is_Frame_Come		; 半秒为0时进判断帧
   142 00:F289: 09            	rts
   143                        ; 判断是否需要减时，还是单纯的动画帧
   144                        Is_Frame_Come:
   145 00:F28A: 31 AB 04      	bbr1	Timer_Flag,Add_Sec_Out			; 有走时标志则减时
   146 00:F28D: 79 B4         	dec		R_Time_Sec
   147 00:F28F: 21 AB         	rmb1	Timer_Flag						; 动画要播放8帧，减时只减1次
   148                        ; 若16Hz没到，不进动画
   149                        Add_Sec_Out:
   150 00:F291: 3F AB 01      	bbs7	Timer_Flag, Count_Start			; 无16Hz标志则不走帧
   151 00:F294: 09            	rts
   152                        
   153                        Count_Start:
   154 00:F295: 73 A9         	lda		Frame_Counter					; 测试用，监视帧计数的值
   155 00:F297: 79 A9         	dec		Frame_Counter					; 帧计数
   156                        
   157 00:F299: 73 B4         	lda		R_Time_Sec						; 判断是否有借位
   158 00:F29B: 04            	clc
   159 00:F29C: 54 01         	adc		#$01
   160 00:F29E: 56 00         	cmp		#$00
   161 00:F2A0: 12 02         	bne		Set_BorrowFlag_Out				; 置借位发生标志
   162 00:F2A2: 2A AE         	smb2	Frame_Flag
   163                        Set_BorrowFlag_Out:
   164 00:F2A4: 32 AE 02      	bbr2	Frame_Flag,Borrow_Out
   165 00:F2A7: 17 34         	bra		L_BorrowToMin
   166                        Borrow_Out:
   167 00:F2A9: 15 E1 F7      	jsr		F_DisFrame_Sec_d4				; sec个位走时动画
   168                        
   169 00:F2AC: 73 B4         	lda		R_Time_Sec						; 检测秒十位有没有借位
   170 00:F2AE: 04            	clc
   171 00:F2AF: 54 01         	adc		#$01							; 由于是计时是减1才进动画，这里加1才是正常的当前秒数
   172 00:F2B1: 15 74 F2      	jsr		F_DivideBy10					; 除以10的结果不为零，且余数为0才执行十位的动画
   173 00:F2B4: 56 00         	cmp		#0								; 商为0则一定无十位，d3无动画
   174 00:F2B6: 13 09         	beq		L_Sec_D3_Out_Des
   175 00:F2B8: 73 B6         	lda		P_Temp							; 余数不为0也不更新十位
   176 00:F2BA: 56 00         	cmp		#0
   177 00:F2BC: 12 03         	bne		L_Sec_D3_Out_Des
   178                        
   179 00:F2BE: 15 FA F7      	jsr		F_DisFrame_Sec_d3				; sec十位走时动画
   180                        
   181                        
   182                        L_Sec_D3_Out_Des:
   183 00:F2C1: 73 A9         	lda		Frame_Counter					; 走到第8帧就重置帧计数
   184 00:F2C3: 56 00         	cmp		#$0
   185 00:F2C5: 13 08         	beq		L_Sec_Des_Out
   186                        
   187 00:F2C7: 5E 54         	ldx		#lcd_MS
   188 00:F2C9: 15 BB F4      	jsr		F_ClrpSymbol					; 若没走完动画则熄MS
   189                        
   190 00:F2CC: 27 AB         	rmb7	Timer_Flag						; 清掉16Hz标志，避免没到16Hz就重复进入动画
   191                        
   192 00:F2CE: 09            	rts
   193                        
   194                        L_Sec_Des_Out:
   195 00:F2CF: 20 AB         	rmb0	Timer_Flag						; 所有动画帧走完后即为后半秒
   196 00:F2D1: 27 AB         	rmb7	Timer_Flag						; 清掉16Hz标志
   197 00:F2D3: 5E 54         	ldx		#lcd_MS							; 亮MS并重置帧计数
   198 00:F2D5: 15 B4 F4      	jsr		F_DispSymbol
   199 00:F2D8: 53 08         	lda		#$8
   200 00:F2DA: 7F A9         	sta		Frame_Counter
   201                        
   202                        L_Sec_Des_rts:
   203 00:F2DC: 09            	rts
   204                        
   205                        L_BorrowToMin:
   206 00:F2DD: 2A AE         	smb2	Frame_Flag
   207 00:F2DF: 39 AE 08      	bbs1	Frame_Flag,Dec_Once_Min			; 借位减分钟，播放8帧动画，但减时只减1次
   208 00:F2E2: 79 B5         	dec		R_Time_Min
   209 00:F2E4: 53 3B         	lda		#59
   210 00:F2E6: 7F B4         	sta		R_Time_Sec
   211 00:F2E8: 29 AE         	smb1	Frame_Flag
   212                        Dec_Once_Min:
   213 00:F2EA: 73 B5         	lda		R_Time_Min
   214 00:F2EC: 04            	clc
   215 00:F2ED: 54 01         	adc		#$01
   216 00:F2EF: 56 00         	cmp		#$00
   217 00:F2F1: 13 38         	beq		L_Time_Stop						; 计到00:00则停止
   218                        
   219 00:F2F3: 15 E1 F7      	jsr		F_DisFrame_Sec_d4				; Sec个位走时动画
   220 00:F2F6: 15 FA F7      	jsr		F_DisFrame_Sec_d3				; Sec十位走时动画
   221 00:F2F9: 15 16 F8      	jsr		F_DisFrame_Min_d2				; Min个位走时动画
   222                        
   223 00:F2FC: 73 B5         	lda		R_Time_Min						; 检测十位有没有借位
   224 00:F2FE: 04            	clc
   225 00:F2FF: 54 01         	adc		#$01
   226 00:F301: 15 74 F2      	jsr		F_DivideBy10					; 除以10的结果不为零，且余数为0才执行十位的动画
   227 00:F304: 56 00         	cmp		#0								; 商为0则一定无十位，d3无动画
   228 00:F306: 13 09         	beq		L_Min_D1_Out_Des
   229 00:F308: 73 B6         	lda		P_Temp							; 余数不为0也不更新十位
   230 00:F30A: 56 00         	cmp		#0
   231 00:F30C: 12 03         	bne		L_Min_D1_Out_Des
   232                        
   233 00:F30E: 15 2B F8      	jsr		F_DisFrame_Min_d1				; Min十位走时动画
   234                        
   235                        L_Min_D1_Out_Des:
   236 00:F311: 73 A9         	lda		Frame_Counter					; 还在走动画就熄MS
   237 00:F313: 56 00         	cmp		#$0
   238 00:F315: 13 06         	beq		L_Min_Des_Out
   239 00:F317: 5E 54         	ldx		#lcd_MS
   240 00:F319: 15 BB F4      	jsr		F_ClrpSymbol
   241 00:F31C: 09            	rts
   242                        
   243                        L_Min_Des_Out:
   244 00:F31D: 21 AE         	rmb1	Frame_Flag						; 置0减时标志位以便下次借位
   245 00:F31F: 22 AE         	rmb2	Frame_Flag						; 清借位标志位，不用再进借位动画
   246 00:F321: 5E 54         	ldx		#lcd_MS							; 走到第8帧就重置帧计数
   247 00:F323: 15 B4 F4      	jsr		F_DispSymbol					; 不走动画了就亮MS
   248 00:F326: 53 08         	lda		#$8
   249 00:F328: 7F A9         	sta		Frame_Counter
   250 00:F32A: 09            	rts
   251                        
   252                        L_Time_Stop:
   253 00:F32B: 53 01         	lda		#$01							; 倒计时完成则回到初始态
   254 00:F32D: 7F AC         	sta		Sys_Status_Flag
   255 00:F32F: 2B AB         	smb3	Timer_Flag						; 计时完成标志位
   256 00:F331: 53 08         	lda		#$08							; 设置响铃序列
   257 00:F333: 7F AA         	sta		Beep_Serial
   258 00:F335: 53 00         	lda		#$0
   259 00:F337: 7F B5         	sta		R_Time_Min
   260 00:F339: 7F B4         	sta		R_Time_Sec
   261 00:F33B: 15 A5 F7      	jsr		F_Display_Time
   262 00:F33E: 09            	rts
   262                        
   192                        .INCLUDE	Beep.asm
     1                        F_Beep_Manage:
     2                        	TMR1_ON
+    2 00:F33F: 29 16          SMB1 TMRC
     3                        
     4 00:F341: 35 AB 15      	bbr5	Timer_Flag,L_Beep_rts			; 响铃的持续和间隔都是1/32秒
     5 00:F344: 25 AB         	rmb5	Timer_Flag						; 清掉1/32秒标志位
     6 00:F346: 73 AA         	lda		Beep_Serial						; 响铃序列全为0则响铃结束
     7 00:F348: 56 00         	cmp		#$0
     8 00:F34A: 13 0E         	beq		L_Beep_Over
     9                        
    10 00:F34C: 30 AA 06      	bbr0	Beep_Serial,L_No_Beep			; 判断响铃序列第一位，为1就响，为0就不响
    11 00:F34F: 2F 16         	smb7	TMRC
    12 00:F351: 79 AA         	dec		Beep_Serial
    13 00:F353: 17 04         	bra		L_Beep_rts
    14                        
    15                        L_No_Beep:
    16 00:F355: 27 16         	rmb7	TMRC
    17 00:F357: 79 AA         	dec		Beep_Serial
    18                        
    19                        L_Beep_rts:
    20 00:F359: 09            	rts
    21                        
    22                        L_Beep_Over:								; 关闭定时器和蜂鸣输出，复位相应标志位
    23                        	TMR1_OFF
+   23 00:F35A: 21 16          RMB1 TMRC
    24 00:F35C: 27 16         	rmb7	TMRC
    25 00:F35E: 22 AB         	rmb2	Timer_Flag
    26 00:F360: 23 AB         	rmb3	Timer_Flag
    27 00:F362: 09            	rts
    27                        
   193                        .INCLUDE	Init.asm
     1                        L_Init_SystemRam_Prog:							; 系统初始化
     2 00:F363: 53 00         	lda		#0
     3 00:F365: 7F AD         	sta		Key_Flag
     4 00:F367: 7F AA         	sta		Beep_Serial
     5 00:F369: 7F A6         	sta		Counter_4Hz
     6 00:F36B: 7F A5         	sta		Counter_1Hz
     7 00:F36D: 7F A7         	sta		Counter_16Hz
     8 00:F36F: 7F A9         	sta		Frame_Counter
     9 00:F371: 7F AE         	sta		Frame_Flag
    10 00:F373: 7F A8         	sta		TimeCnt
    11 00:F375: 7F AB         	sta		Timer_Flag
    12                        
    13 00:F377: 53 01         	lda		#$01
    14 00:F379: 7F AC         	sta		Sys_Status_Flag
    15                        
    16 00:F37B: 53 00         	lda		#0
    17 00:F37D: 7F B5         	sta		R_Time_Min
    18 00:F37F: 53 00         	lda		#0
    19 00:F381: 7F B4         	sta		R_Time_Sec
    20                        
    21 00:F383: 09            	rts
    22                        
    23                        
    24                        F_LCD_Init:
    25 00:F384: 15 35 F4      	jsr		F_ClearScreen						; LCD初始化
    26                        	CHECK_LCD
+   26 00:F387: 53 FE          LDA #$00FE
+   26 00:F389: 7F 08          STA P_PC_DIR
+   26 00:F38B: 53 FE          LDA #$00FE
+   26 00:F38D: 7F 07          STA P_PC
+   26 00:F38F: 1A             NOP
+   26 00:F390: 1A             NOP
+   26 00:F391: 1A             NOP
+   26 00:F392: 73 07          LDA P_PC
+   26 00:F394: 51 02          AND #$0002
+   26                        ?_Loop
+   26 00:F396: 7F B7          STA P_Temp+$0001
+   26 00:F398: 53 0F          LDA #$000F
+   26                        ?_LoopPort
+   26 00:F39A: 07             DEC
+   26 00:F39B: 12 FD          BNE ?_LoopPort
+   26 00:F39D: 73 07          LDA P_PC
+   26 00:F39F: 51 02          AND #$0002
+   26 00:F3A1: 7F B6          STA P_Temp
+   26 00:F3A3: 76 B7          CMP P_Temp+$0001
+   26 00:F3A5: 12 EF          BNE ?_Loop
+   26 00:F3A7: 39 B6 1D       BBS1 P_Temp,?LCD_R_Type
+   26                        ?LCD_C_Type:
+   26                         LCD_C_TYPE
+   26 00:F3AA: 2F 1A          SMB7 LCDCOM
+   26 00:F3AC: 28 09          SMB0 PCSEG
+   26 00:F3AE: 29 09          SMB1 PCSEG
+   26 00:F3B0: 2A 09          SMB2 PCSEG
+   26 00:F3B2: 2B 09          SMB3 PCSEG
+   26                         LCD_ENCH_EN
+   26 00:F3B4: 2E 1A          SMB6 LCDCOM
+   26                         LCD_5COM
+   26 00:F3B6: 20 1A          RMB0 LCDCOM
+   26 00:F3B8: 21 1A          RMB1 LCDCOM
+   26 00:F3BA: 2A 1A          SMB2 LCDCOM
+   26                         LCD_DRIVE_8
+   26 00:F3BC: 28 19          SMB0 LCDCTRL
+   26 00:F3BE: 29 19          SMB1 LCDCTRL
+   26                         LCD_C_1_3_BAIS_3V
+   26 00:F3C0: 2A 19          SMB2 LCDCTRL
+   26 00:F3C2: 23 19          RMB3 LCDCTRL
+   26 00:F3C4: 16 D3 F3       JMP ?Exit
+   26                        ?LCD_R_Type:
+   26                         LCD_R_TYPE
+   26 00:F3C7: 27 1A          RMB7 LCDCOM
+   26                        
+   26                         LCD_5COM
+   26 00:F3C9: 20 1A          RMB0 LCDCOM
+   26 00:F3CB: 21 1A          RMB1 LCDCOM
+   26 00:F3CD: 2A 1A          SMB2 LCDCOM
+   26                        
+   26                         LCD_R_1_3_BAIS
+   26 00:F3CF: 22 19          RMB2 LCDCTRL
+   26 00:F3D1: 23 19          RMB3 LCDCTRL
+   26                        
+   26                        ?Exit:
+   26 00:F3D3: 53 00          LDA #$0000
+   26 00:F3D5: 7F 08          STA P_PC_IO
+   26 00:F3D7: 7F 07          STA P_PC
+   26                        
+   26                        
    27                        
    28                        	PC45_SEG									; 配置IO口为SEG线模式
+   28 00:F3D9: 2C 09          SMB4 PCSEG
    29                        	PC67_SEG
+   29 00:F3DB: 2D 09          SMB5 PCSEG
    30                        	PD03_SEG
+   30 00:F3DD: 2E 09          SMB6 PCSEG
    31                        	PD47_SEG
+   31 00:F3DF: 2F 09          SMB7 PCSEG
    32                        
    33 00:F3E1: 20 1A         	RMB0	P_LCD_COM							; 配置COM线数量
    34 00:F3E3: 29 1A         	SMB1	P_LCD_COM
    35                        
    36                        	LCD_ON
+   36 00:F3E5: 2C 16          SMB4 TMRC
    37 00:F3E7: 15 35 F4      	jsr		F_ClearScreen						; 清屏
    38                        
    39 00:F3EA: 09            	rts
    40                        
    41                        
    42                        F_Port_Init:
    43 00:F3EB: 53 A4         	LDA		#$A4								; PA2\5\7作按键输入
    44 00:F3ED: 7F 02         	STA		P_PA_WAKE
    45 00:F3EF: 7F 04         	STA		P_PA_IO
    46 00:F3F1: 53 FF         	LDA		#$FF
    47 00:F3F3: 7F 01         	STA		P_PA
    48                        	EN_PA_IRQ									; 打开PA口外部中断
+   48 00:F3F5: 2C 0E          SMB4 IER
    49                        
    50                        	PB2_PWM
+   50 00:F3F7: 28 0C          SMB0 PADF0
+   50 00:F3F9: 2A 06          SMB2 PBTYPE
    51                        	PB3_PB3_COMS
+   51 00:F3FB: 21 0C          RMB1 PADF0
+   51 00:F3FD: 2B 06          SMB3 PBTYPE
    52                        
    53 00:F3FF: 09            	rts
    54                        
    55                        
    56                        F_Timer_Init:
    57                        	TMR1_CLK_512Hz								; TIM1时钟源Fsub/64(512Hz)
+   57 00:F400: 2A 17          SMB2 TMCLK
+   57 00:F402: 23 17          RMB3 TMCLK
    58                        	TMR0_CLK_FSUB								; TIM0时钟源Fsub(32768Hz)
+   58 00:F404: 20 17          RMB0 TMCLK
+   58 00:F406: 21 17          RMB1 TMCLK
+   58 00:F408: 20 0D          RMB0 PADF1
    59                        	DIV_256HZ									; DIV分频512Hz
+   59 00:F40A: 2D 18          SMB5 DIVC
    60                        
    61 00:F40C: 53 00         	lda		#$0									; 重装载计数设置为0
    62 00:F40E: 7F 10         	sta		TMR0
    63 00:F410: 7F 14         	sta		TMR2
    64                        
    65 00:F412: 53 EF         	lda		#$ef
    66 00:F414: 7F 12         	sta		TMR1
    67                        
    68 00:F416: 26 18         	rmb6	DIVC								; 关闭定时器同步
    69                        
    70                        	EN_TMR1_IRQ									; 开定时器中断
+   70 00:F418: 2A 0E          SMB2 IER
    71                        	EN_TMR2_IRQ
+   71 00:F41A: 2B 0E          SMB3 IER
    72                        	EN_TMR0_IRQ
+   72 00:F41C: 29 0E          SMB1 IER
    73                        	TMR0_OFF
+   73 00:F41E: 20 16          RMB0 TMRC
    74                        	TMR1_OFF
+   74 00:F420: 21 16          RMB1 TMRC
    75                        	TMR2_OFF
+   75 00:F422: 22 16          RMB2 TMRC
    76                        
    77 00:F424: 09            	rts
    78                        
    79                        
    80                        F_Beep_Init:
    81                        	TONE_2KHZ									; 配置蜂鸣器音调频率
+   81 00:F425: 22 18          RMB2 DIVC
+   81 00:F427: 23 18          RMB3 DIVC
    82 00:F429: 53 00         	lda		#$0
    83 00:F42B: 7F 20         	sta		AUDCR
    84 00:F42D: 53 FF         	lda		#$ff
    85 00:F42F: 7F 1F         	sta		P_AUD
    85                        
   194                        .INCLUDE	Disp.asm
     1                        ;===========================================================
     2                        ; LCD_RamAddr		.equ	0200H
     3                        ;===========================================================
     4                        F_FillScreen:
     5 00:F431: 53 FF         	LDA		#FFH
     6 00:F433: 12 02         	BNE		L_FillLcd
     7                        F_ClearScreen:
     8 00:F435: 53 00         	LDA		#0
     9                        L_FillLcd:
    10 00:F437: 4F 00 18      	STA		1800H
    11 00:F43A: 4F 01 18      	STA		1801H
    12 00:F43D: 4F 05 18      	STA		1805H
    13 00:F440: 4F 06 18      	STA		1806H
    14 00:F443: 4F 07 18      	STA		1807H
    15 00:F446: 4F 0B 18      	STA		180BH
    16 00:F449: 4F 0C 18      	STA		180CH
    17 00:F44C: 4F 0D 18      	STA		180DH
    18 00:F44F: 4F 11 18      	STA		1811H
    19 00:F452: 4F 12 18      	STA		1812H
    20 00:F455: 4F 13 18      	STA		1813H
    21 00:F458: 4F 17 18      	STA		1817H
    22 00:F45B: 4F 18 18      	STA		1818H
    23 00:F45E: 4F 19 18      	STA		1819H
    24 00:F461: 4F 1D 18      	STA		181DH
    25                        
    26 00:F464: 09            	RTS
    27                        ;===========================================================
    28                        ;@brief		显示完整的一个数字
    29                        ;@para:		A = 0~9
    30                        ;			X = offset
    31                        ;@impact:	P_Temp，P_Temp+1，P_Temp+2，P_Temp+3, P_Temp+4, P_Temp+5, X，A
    32                        ;===========================================================
    33                        L_Dis_21Bit_DigitDot_Prog:
    34                        ;	STA		P_Temp
    35                        ;	LDA		Table_Digit_Addr_Offset,X
    36 00:F465: 7C B9         	STX		P_Temp+3					; 偏移量暂存进P_Temp+3, 腾出X来做变址寻址
    37 00:F467: 7F B6         	STA		P_Temp						; 将显示的数字转换为内存偏移量
    38 00:F469: 15 4A F8      	jsr		L_Multi_24_Prog				; 乘24得到正确的偏移量
    39                        
    40 00:F46C: 1B            	TAX
    41 00:F46D: 63 75 F5      	LDA		Table_Digit_Anim,X			; 将显示的数字通过查表找到对应的段码存进A
    42 00:F470: 7F B6         	STA		P_Temp						; 暂存低八位段码值到P_Temp
    43 00:F472: 0B            	INX
    44 00:F473: 63 75 F5      	LDA		Table_Digit_Anim,X			; 将显示的数字通过查表找到对应的段码存进A
    45 00:F476: 7F B7         	STA		P_Temp+1					; 暂存段码中8位值到P_Temp+1
    46 00:F478: 0B            	INX
    47 00:F479: 63 75 F5      	LDA		Table_Digit_Anim,X			; 将显示的数字通过查表找到对应的段码存进A
    48 00:F47C: 7F B8         	STA		P_Temp+2					; 暂存高8位段码值到P_Temp+2
    49                        
    50 00:F47E: 7E B9         	LDX		P_Temp+3					; 将偏移量取回
    51 00:F480: 7C B9         	STX		P_Temp+3					; 暂存偏移量到P_Temp+3
    52 00:F482: 53 15         	LDA		#21
    53 00:F484: 7F BA         	STA		P_Temp+4					; 设置显示段数为21
    54                        L_Judge_Dis_21Bit_DigitDot:				; 显示循环的开始
    55 00:F486: 7E B9         	LDX		P_Temp+3					; 取回偏移量作为索引
    56 00:F488: 63 50 F7      	LDA		Lcd_bit,X					; 查表定位目标段的bit位
    57 00:F48B: 7F BB         	STA		P_Temp+5
    58 00:F48D: 63 FB F6      	LDA		Lcd_byte,X					; 查表定位目标段的显存地址
    59 00:F490: 1B            	TAX
    60 00:F491: 7B B6         	ROR		P_Temp						; 循环右移取得目标段是亮或者灭
    61 00:F493: 7B B7         	ROR		P_Temp+1
    62 00:F495: 7B B8         	ROR		P_Temp+2
    63 00:F497: 10 0A         	BCC		L_CLR						; 当前段的值若是0则进清点子程序
    64 00:F499: 63 00 18      	LDA		LCD_RamAddr,X				; 将目标段的显存的特定bit位置1来打亮
    65 00:F49C: 70 BB         	ORA		P_Temp+5
    66 00:F49E: 6F 00 18      	STA		LCD_RamAddr,X
    67 00:F4A1: 17 0A         	BRA		L_Inc_Dis_Index_Prog		; 跳转到显示索引增加的子程序。
    68                        L_CLR:
    69 00:F4A3: 63 00 18      	LDA		LCD_RamAddr,X				; 加载LCD RAM的地址
    70 00:F4A6: 70 BB         	ORA		P_Temp+5					; 将COM和SEG信息与LCD RAM地址进行逻辑或操作
    71 00:F4A8: 72 BB         	EOR		P_Temp+5					; 进行异或操作，用于清除对应的段。
    72 00:F4AA: 6F 00 18      	STA		LCD_RamAddr,X				; 将结果写回LCD RAM，清除对应位置。
    73                        L_Inc_Dis_Index_Prog:
    74 00:F4AD: 78 B9         	INC		P_Temp+3					; 递增偏移量，处理下一个段
    75 00:F4AF: 79 BA         	DEC		P_Temp+4					; 递减剩余要显示的段数
    76 00:F4B1: 12 D3         	BNE		L_Judge_Dis_21Bit_DigitDot	; 剩余段数为0则返回
    77 00:F4B3: 09            	RTS
    78                        
    79                        ;-----------------------------------------
    80                        ;@brief:	单独的画点、清点函数,一般用于MS显示
    81                        ;@para:		X = offset
    82                        ;@impact:	A, X, P_Temp+2
    83                        ;-----------------------------------------
    84                        F_DispSymbol:
    85 00:F4B4: 15 C4 F4      	JSR		F_DispSymbol_Com
    86 00:F4B7: 6F 00 18      	STA		LCD_RamAddr,X				; 画点
    87 00:F4BA: 09            	RTS
    88                        
    89                        F_ClrpSymbol:
    90 00:F4BB: 15 C4 F4      	JSR		F_DispSymbol_Com			; 清点
    91 00:F4BE: 72 B8         	EOR		P_Temp+2
    92 00:F4C0: 6F 00 18      	STA		LCD_RamAddr,X
    93 00:F4C3: 09            	RTS
    94                        
    95                        F_DispSymbol_Com:
    96 00:F4C4: 63 50 F7      	LDA		Lcd_bit,X					; 查表得知目标段的bit位
    97 00:F4C7: 7F B8         	STA		P_Temp+2
    98 00:F4C9: 63 FB F6      	LDA		Lcd_byte,X					; 查表得知目标段的地址
    99 00:F4CC: 1B            	TAX
   100 00:F4CD: 63 00 18      	LDA		LCD_RamAddr,X				; 将目标段的显存的特定bit位置1来打亮
   101 00:F4D0: 70 B8         	ORA		P_Temp+2
   102 00:F4D2: 09            	RTS
   103                        
   104                        ;============================================================
   105                        
   106                        L_Dis_21Bit_DigitFrame_Prog:
   107 00:F4D3: 7C B9         	STX		P_Temp+3					; 偏移量暂存进P_Temp+3, 腾出X来做变址寻址
   108 00:F4D5: 7F B6         	STA		P_Temp						; 将显示的数字转换为内存偏移量
   109 00:F4D7: 04            	CLC
   110 00:F4D8: 18            	ROL
   111 00:F4D9: 04            	CLC
   112 00:F4DA: 74 B6         	ADC		P_Temp
   113                        
   114 00:F4DC: 1B            	TAX
   115 00:F4DD: 63 75 F5      	LDA		Table_Digit_Anim,X			; 将显示的数字通过查表找到对应的段码存进A
   116 00:F4E0: 7F B6         	STA		P_Temp						; 暂存低八位段码值到P_Temp
   117 00:F4E2: 0B            	INX
   118 00:F4E3: 63 75 F5      	LDA		Table_Digit_Anim,X			; 将显示的数字通过查表找到对应的段码存进A
   119 00:F4E6: 7F B7         	STA		P_Temp+1					; 暂存段码中8位值到P_Temp+1
   120 00:F4E8: 0B            	INX
   121 00:F4E9: 63 75 F5      	LDA		Table_Digit_Anim,X			; 将显示的数字通过查表找到对应的段码存进A
   122 00:F4EC: 7F B8         	STA		P_Temp+2					; 暂存高8位段码值到P_Temp+2
   123                        
   124 00:F4EE: 7E B9         	LDX		P_Temp+3					; 将偏移量取回
   125                        
   126 00:F4F0: 7C B9         	STX		P_Temp+3					; 暂存偏移量到P_Temp+3
   127 00:F4F2: 53 15         	LDA		#21
   128 00:F4F4: 7F BA         	STA		P_Temp+4					; 设置显示段数为21
   129                        L_Judge_Dis_21Bit_DigitFrame:				; 显示循环的开始
   130 00:F4F6: 7E B9         	LDX		P_Temp+3					; 取回偏移量作为索引
   131 00:F4F8: 63 50 F7      	LDA		Lcd_bit,X					; 查表定位目标段的bit位
   132 00:F4FB: 7F BB         	STA		P_Temp+5
   133 00:F4FD: 63 FB F6      	LDA		Lcd_byte,X					; 查表定位目标段的显存地址
   134 00:F500: 1B            	TAX
   135 00:F501: 7B B6         	ROR		P_Temp						; 循环右移取得目标段是亮或者灭
   136 00:F503: 7B B7         	ROR		P_Temp+1
   137 00:F505: 7B B8         	ROR		P_Temp+2
   138 00:F507: 10 0A         	BCC		L_CLR_Frame					; 当前段的值若是0则进清点子程序
   139 00:F509: 63 00 18      	LDA		LCD_RamAddr,X				; 将目标段的显存的特定bit位置1来打亮
   140 00:F50C: 70 BB         	ORA		P_Temp+5
   141 00:F50E: 6F 00 18      	STA		LCD_RamAddr,X
   142 00:F511: 17 0A         	BRA		L_Inc_Dis_FrameIndex_Prog		; 跳转到显示索引增加的子程序。
   143                        L_CLR_Frame:
   144 00:F513: 63 00 18      	LDA		LCD_RamAddr,X				; 加载LCD RAM的地址
   145 00:F516: 70 BB         	ORA		P_Temp+5					; 将COM和SEG信息与LCD RAM地址进行逻辑或操作
   146 00:F518: 72 BB         	EOR		P_Temp+5					; 进行异或操作，用于清除对应的段。
   147 00:F51A: 6F 00 18      	STA		LCD_RamAddr,X				; 将结果写回LCD RAM，清除对应位置。
   148                        L_Inc_Dis_FrameIndex_Prog:
   149 00:F51D: 78 B9         	INC		P_Temp+3					; 递增偏移量，处理下一个段
   150 00:F51F: 79 BA         	DEC		P_Temp+4					; 递减剩余要显示的段数
   151 00:F521: 12 D3         	BNE		L_Judge_Dis_21Bit_DigitFrame	; 剩余段数为0则返回
   152 00:F523: 09            	RTS
   153                        
   154                        ;================================================================================
   155                        
   156                        L_Dis_21Bit_DigitFrame_Prog_1:
   157 00:F524: 7C B9         	STX		P_Temp+3					; 偏移量暂存进P_Temp+3, 腾出X来做变址寻址
   158 00:F526: 7F B6         	STA		P_Temp						; 将显示的数字转换为内存偏移量
   159 00:F528: 04            	CLC
   160 00:F529: 18            	ROL
   161 00:F52A: 04            	CLC
   162 00:F52B: 74 B6         	ADC		P_Temp
   163                        
   164 00:F52D: 1B            	TAX
   165 00:F52E: 63 68 F6      	LDA		Table_Digit_Anim_2,X		; 将显示的数字通过查表找到对应的段码存进A
   166 00:F531: 7F B6         	STA		P_Temp						; 暂存低八位段码值到P_Temp
   167 00:F533: 0B            	INX
   168 00:F534: 63 68 F6      	LDA		Table_Digit_Anim_2,X			; 将显示的数字通过查表找到对应的段码存进A
   169 00:F537: 7F B7         	STA		P_Temp+1					; 暂存段码中8位值到P_Temp+1
   170 00:F539: 0B            	INX
   171 00:F53A: 63 68 F6      	LDA		Table_Digit_Anim_2,X			; 将显示的数字通过查表找到对应的段码存进A
   172 00:F53D: 7F B8         	STA		P_Temp+2					; 暂存高8位段码值到P_Temp+2
   173                        
   174 00:F53F: 7E B9         	LDX		P_Temp+3					; 将偏移量取回
   175                        
   176 00:F541: 7C B9         	STX		P_Temp+3					; 暂存偏移量到P_Temp+3
   177 00:F543: 53 15         	LDA		#21
   178 00:F545: 7F BA         	STA		P_Temp+4					; 设置显示段数为21
   179                        L_Judge_Dis_21Bit_DigitFrame_1:				; 显示循环的开始
   180 00:F547: 7E B9         	LDX		P_Temp+3					; 取回偏移量作为索引
   181 00:F549: 63 50 F7      	LDA		Lcd_bit,X					; 查表定位目标段的bit位
   182 00:F54C: 7F BB         	STA		P_Temp+5
   183 00:F54E: 63 FB F6      	LDA		Lcd_byte,X					; 查表定位目标段的显存地址
   184 00:F551: 1B            	TAX
   185 00:F552: 7B B6         	ROR		P_Temp						; 循环右移取得目标段是亮或者灭
   186 00:F554: 7B B7         	ROR		P_Temp+1
   187 00:F556: 7B B8         	ROR		P_Temp+2
   188 00:F558: 10 0A         	BCC		L_CLR_Frame_1				; 当前段的值若是0则进清点子程序
   189 00:F55A: 63 00 18      	LDA		LCD_RamAddr,X				; 将目标段的显存的特定bit位置1来打亮
   190 00:F55D: 70 BB         	ORA		P_Temp+5
   191 00:F55F: 6F 00 18      	STA		LCD_RamAddr,X
   192 00:F562: 17 0A         	BRA		L_Inc_Dis_FrameIndex_Prog_1	; 跳转到显示索引增加的子程序。
   193                        L_CLR_Frame_1:
   194 00:F564: 63 00 18      	LDA		LCD_RamAddr,X				; 加载LCD RAM的地址
   195 00:F567: 70 BB         	ORA		P_Temp+5					; 将COM和SEG信息与LCD RAM地址进行逻辑或操作
   196 00:F569: 72 BB         	EOR		P_Temp+5					; 进行异或操作，用于清除对应的段。
   197 00:F56B: 6F 00 18      	STA		LCD_RamAddr,X				; 将结果写回LCD RAM，清除对应位置。
   198                        L_Inc_Dis_FrameIndex_Prog_1:
   199 00:F56E: 78 B9         	INC		P_Temp+3					; 递增偏移量，处理下一个段
   200 00:F570: 79 BA         	DEC		P_Temp+4					; 递减剩余要显示的段数
   201 00:F572: 12 D3         	BNE		L_Judge_Dis_21Bit_DigitFrame_1	; 剩余段数为0则返回
   202 00:F574: 09            	RTS
   203                        
   204                        ;============================================================
   205                        
   206                        Table_Digit_Anim:
   207 00:F575: 1E DB 6F      	.byte $1e, $db, $6f	;0			0
   208 00:F578: 03 DB 6D      	.byte $03, $db, $6d	;0->1, 1	1
   209 00:F57B: 10 7B 6D      	.byte $10, $7b, $6d	;0->1, 2	2
   210 00:F57E: 12 0F 6D      	.byte $12, $0f, $6d ;0->1, 3	3
   211 00:F581: 12 41 ED      	.byte $12, $41, $ed ;0->1, 4	4
   212 00:F584: 12 48 3D      	.byte $12, $48, $3d ;0->1, 5	5
   213 00:F587: 12 49 07      	.byte $12, $49, $07 ;0->1, 6	6
   214 00:F58A: 12 49 20      	.byte $12, $49, $20 ;0->1, 7	7
   215 00:F58D: 12 49 24      	.byte $12, $49, $24 ;1			8
   216 00:F590: 02 49 24      	.byte $02, $49, $24	;1->2, 1	9
   217 00:F593: 1C 49 24      	.byte $1c, $49, $24	;1->2, 2	a
   218 00:F596: 13 89 24      	.byte $13, $89, $24 ;1->2, 3	b
   219 00:F599: 12 71 24      	.byte $12, $71, $24 ;1->2, 4	c
   220 00:F59C: 1E 4E 24      	.byte $1e, $4e, $24 ;1->2, 5	d
   221 00:F59F: 07 C9 C4      	.byte $07, $c9, $c4 ;1->2, 6	e
   222 00:F5A2: 04 F9 38      	.byte $04, $f9, $38 ;1->2, 7	f
   223 00:F5A5: 1C 9F 27      	.byte $1c, $9f, $27 ;2			10
   224 00:F5A8: 03 93 E4      	.byte $03, $93, $e4	;2->3, 1	11
   225 00:F5AB: 1C 72 7C      	.byte $1c, $72, $7c	;2->3, 2	12
   226 00:F5AE: 13 8E 4F      	.byte $13, $8e, $4f ;2->3, 3	13
   227 00:F5B1: 12 71 C9      	.byte $12, $71, $c9 ;2->3, 4	14
   228 00:F5B4: 1E 4E 39      	.byte $1e, $4e, $39 ;2->3, 5	15
   229 00:F5B7: 13 C9 C7      	.byte $13, $c9, $c7 ;2->3, 6	16
   230 00:F5BA: 12 79 38      	.byte $12, $79, $38 ;2->3, 7	17
   231 00:F5BD: 1E 4F 27      	.byte $1e, $4f, $27 ;3			18
   232 00:F5C0: 03 C9 E4      	.byte $03, $c9, $e4	;3->4, 1	19
   233 00:F5C3: 14 79 3C      	.byte $14, $79, $3c	;3->4, 2	1a
   234 00:F5C6: 16 8F 27      	.byte $16, $8f, $27 ;3->4, 3	1b
   235 00:F5C9: 16 D1 E4      	.byte $16, $d1, $e4 ;3->4, 4	1c
   236 00:F5CC: 1E DA 3C      	.byte $1e, $da, $3c ;3->4, 5	1d
   237 00:F5CF: 13 DB 47      	.byte $13, $db, $47 ;3->4, 6	1e
   238 00:F5D2: 12 7B 68      	.byte $12, $7b, $68 ;3->4, 7	1f
   239 00:F5D5: 12 4F 6D      	.byte $12, $4f, $6d ;4			20
   240 00:F5D8: 02 49 ED      	.byte $02, $49, $ed	;4->5, 1	21
   241 00:F5DB: 1C 49 3D      	.byte $1c, $49, $3d	;4->5, 2	22
   242 00:F5DE: 07 89 27      	.byte $07, $89, $27 ;4->5, 3	23
   243 00:F5E1: 04 F1 24      	.byte $04, $f1, $24 ;4->5, 4	24
   244 00:F5E4: 1C 9E 24      	.byte $1c, $9e, $24 ;4->5, 5	25
   245 00:F5E7: 13 93 C4      	.byte $13, $93, $c4 ;4->5, 6	26
   246 00:F5EA: 12 72 78      	.byte $12, $72, $78 ;4->5, 7	27
   247 00:F5ED: 1E 4E 4F      	.byte $1e, $4e, $4f ;5			28
   248 00:F5F0: 03 C9 C9      	.byte $03, $c9, $c9	;5->6, 1	29
   249 00:F5F3: 1C 79 39      	.byte $1c, $79, $39	;5->6, 2	2a
   250 00:F5F6: 07 8F 27      	.byte $07, $8f, $27 ;5->6, 3	2b
   251 00:F5F9: 04 F1 E4      	.byte $04, $f1, $e4 ;5->6, 4	2c
   252 00:F5FC: 1C 9E 3C      	.byte $1c, $9e, $3c ;5->6, 5	2d
   253 00:F5FF: 17 93 C7      	.byte $17, $93, $c7 ;5->6, 6	2e
   254 00:F602: 16 F2 78      	.byte $16, $f2, $78 ;5->6, 7	2f
   255 00:F605: 1E DE 4F      	.byte $1e, $de, $4f ;6			30
   256 00:F608: 03 DB C9      	.byte $03, $db, $c9	;6->7, 1	31
   257 00:F60B: 1C 7B 79      	.byte $1c, $7b, $79	;6->7, 2	32
   258 00:F60E: 13 8F 6F      	.byte $13, $8f, $6f ;6->7, 3	33
   259 00:F611: 12 71 ED      	.byte $12, $71, $ed ;6->7, 4	34
   260 00:F614: 12 4E 3D      	.byte $12, $4e, $3d ;6->7, 5	35
   261 00:F617: 12 49 C7      	.byte $12, $49, $c7 ;6->7, 6	36
   262 00:F61A: 12 49 38      	.byte $12, $49, $38 ;6->7, 7	37
   263 00:F61D: 12 49 27      	.byte $12, $49, $27 ;7			38
   264 00:F620: 02 49 24      	.byte $02, $49, $24	;7->8, 1	39
   265 00:F623: 1C 49 24      	.byte $1c, $49, $24	;7->8, 2	3a
   266 00:F626: 17 89 24      	.byte $17, $89, $24 ;7->8, 3	3b
   267 00:F629: 16 F1 24      	.byte $16, $f1, $24 ;7->8, 4	3c
   268 00:F62C: 1E DE 24      	.byte $1e, $de, $24 ;7->8, 5	3d
   269 00:F62F: 17 DB C4      	.byte $17, $db, $c4 ;7->8, 6	3e
   270 00:F632: 16 FB 78      	.byte $16, $fb, $78 ;7->8, 7	3f
   271 00:F635: 1E DF 6F      	.byte $1e, $df, $6f ;8			40
   272 00:F638: 03 DB ED      	.byte $03, $db, $ed	;8->9, 1	41
   273 00:F63B: 1C 7B 7D      	.byte $1c, $7b, $7d	;8->9, 2	42
   274 00:F63E: 17 8F 6F      	.byte $17, $8f, $6f ;8->9, 3	43
   275 00:F641: 16 F1 ED      	.byte $16, $f1, $ed ;8->9, 4	44
   276 00:F644: 1E DE 3D      	.byte $1e, $de, $3d ;8->9, 5	45
   277 00:F647: 13 DB C4      	.byte $13, $db, $c4 ;8->9, 6	46
   278 00:F64A: 12 7B 78      	.byte $12, $7b, $78 ;8->9, 7	47
   279 00:F64D: 1E 4F 6F      	.byte $1e, $4f, $6f ;9			48
   280 00:F650: 03 C9 ED      	.byte $03, $c9, $ed	;9->0, 1	49
   281 00:F653: 1C 79 3D      	.byte $1c, $79, $3d	;9->0, 2	4a
   282 00:F656: 17 8F 27      	.byte $17, $8f, $27 ;9->0, 3	4b
   283 00:F659: 16 F1 E4      	.byte $16, $f1, $e4 ;9->0, 4	4c
   284 00:F65C: 16 DE 3C      	.byte $16, $de, $3c ;9->0, 5	4d
   285 00:F65F: 16 DB C7      	.byte $16, $db, $c7 ;9->0, 6	4e
   286 00:F662: 16 DB 78      	.byte $16, $db, $78 ;9->0, 7	4f
   287 00:F665: 1E DB 6F      	.byte $1e, $db, $6f ;0			50
   288                        
   289                        Table_Digit_Anim_2:
   290 00:F668: 1E DB 6F      	.byte $1e, $db, $6f	;0			0
   291 00:F66B: 03 DB 6D      	.byte $03, $db, $6d	;0->1, 1	1
   292 00:F66E: 10 7B 6D      	.byte $10, $7b, $6d	;0->1, 2	2
   293 00:F671: 12 0F 6D      	.byte $12, $0f, $6d ;0->1, 3	3
   294 00:F674: 12 41 ED      	.byte $12, $41, $ed ;0->1, 4	4
   295 00:F677: 12 48 3D      	.byte $12, $48, $3d ;0->1, 5	5
   296 00:F67A: 12 49 07      	.byte $12, $49, $07 ;0->1, 6	6
   297 00:F67D: 12 49 20      	.byte $12, $49, $20 ;0->1, 7	7
   298 00:F680: 12 49 24      	.byte $12, $49, $24 ;1			8
   299 00:F683: 02 49 24      	.byte $02, $49, $24	;1->2, 1	9
   300 00:F686: 1C 49 24      	.byte $1c, $49, $24	;1->2, 2	a
   301 00:F689: 13 89 24      	.byte $13, $89, $24 ;1->2, 3	b
   302 00:F68C: 12 71 24      	.byte $12, $71, $24 ;1->2, 4	c
   303 00:F68F: 1E 4E 24      	.byte $1e, $4e, $24 ;1->2, 5	d
   304 00:F692: 07 C9 C4      	.byte $07, $c9, $c4 ;1->2, 6	e
   305 00:F695: 04 F9 38      	.byte $04, $f9, $38 ;1->2, 7	f
   306 00:F698: 1C 9F 27      	.byte $1c, $9f, $27 ;2			10
   307 00:F69B: 03 93 E4      	.byte $03, $93, $e4	;2->3, 1	11
   308 00:F69E: 1C 72 7C      	.byte $1c, $72, $7c	;2->3, 2	12
   309 00:F6A1: 13 8E 4F      	.byte $13, $8e, $4f ;2->3, 3	13
   310 00:F6A4: 12 71 C9      	.byte $12, $71, $c9 ;2->3, 4	14
   311 00:F6A7: 1E 4E 39      	.byte $1e, $4e, $39 ;2->3, 5	15
   312 00:F6AA: 13 C9 C7      	.byte $13, $c9, $c7 ;2->3, 6	16
   313 00:F6AD: 12 79 38      	.byte $12, $79, $38 ;2->3, 7	17
   314 00:F6B0: 1E 4F 27      	.byte $1e, $4f, $27 ;3			18
   315 00:F6B3: 03 C9 E4      	.byte $03, $c9, $e4	;3->4, 1	19
   316 00:F6B6: 14 79 3C      	.byte $14, $79, $3c	;3->4, 2	1a
   317 00:F6B9: 16 8F 27      	.byte $16, $8f, $27 ;3->4, 3	1b
   318 00:F6BC: 16 D1 E4      	.byte $16, $d1, $e4 ;3->4, 4	1c
   319 00:F6BF: 1E DA 3C      	.byte $1e, $da, $3c ;3->4, 5	1d
   320 00:F6C2: 13 DB 47      	.byte $13, $db, $47 ;3->4, 6	1e
   321 00:F6C5: 12 7B 68      	.byte $12, $7b, $68 ;3->4, 7	1f
   322 00:F6C8: 12 4F 6D      	.byte $12, $4f, $6d ;4			20
   323 00:F6CB: 02 49 ED      	.byte $02, $49, $ed	;4->5, 1	21
   324 00:F6CE: 1C 49 3D      	.byte $1c, $49, $3d	;4->5, 2	22
   325 00:F6D1: 07 89 27      	.byte $07, $89, $27 ;4->5, 3	23
   326 00:F6D4: 04 F1 24      	.byte $04, $f1, $24 ;4->5, 4	24
   327 00:F6D7: 1C 9E 24      	.byte $1c, $9e, $24 ;4->5, 5	25
   328 00:F6DA: 13 93 C4      	.byte $13, $93, $c4 ;4->5, 6	26
   329 00:F6DD: 12 72 78      	.byte $12, $72, $78 ;4->5, 7	27
   330 00:F6E0: 1E 4E 4F      	.byte $1e, $4e, $4f ;5			28
   331 00:F6E3: 03 C9 C9      	.byte $03, $c9, $c9	;5->0, 1	29
   332 00:F6E6: 1C 79 39      	.byte $1c, $79, $39	;5->0, 2	2a
   333 00:F6E9: 17 8F 27      	.byte $17, $8f, $27 ;5->0, 3	2b
   334 00:F6EC: 16 F1 E4      	.byte $16, $f1, $e4 ;5->0, 4	2c
   335 00:F6EF: 16 DE 3C      	.byte $16, $de, $3c ;5->0, 5	2d
   336 00:F6F2: 16 DB C7      	.byte $16, $db, $c7 ;5->0, 6	2e
   337 00:F6F5: 16 DB 78      	.byte $16, $db, $78 ;5->0, 7	2f
   338 00:F6F8: 1E DB 6F      	.byte $1e, $db, $6f ;0			30
   338                        
   195                        .INCLUDE	Lcdtab.asm
     1                        ;--------COM------------
     2                        c0	.equ	0
     3                        c1	.equ	1
     4                        c2	.equ	2
     5                        c3	.equ	3
     6                        c4	.equ	4
     7                        ;;--------SEG------------
     8                        s15	.equ	15
     9                        s14	.equ	14
    10                        s13	.equ	13
    11                        s12	.equ	12
    12                        s11	.equ	11
    13                        s10	.equ	10
    14                        s9	.equ	9
    15                        s8	.equ	8
    16                        s7	.equ	7
    17                        s6	.equ	6
    18                        s5	.equ	5
    19                        s4	.equ	4
    20                        s3	.equ	3
    21                        s2	.equ	2
    22                        s1	.equ	1
    23                        s0	.equ	0
    24                        s40	.equ	40
    25                        
    26                        MS_dot .equ	1
    27                        
    28                        
    29                        .MACRO  db_c_s	com,seg
    30                                  .BYTE com*6+seg/8
    31                        .ENDMACRO
    32                        
    33                        .MACRO  db_c_y	com,seg
    34                        	      .BYTE 1.shl.(seg-seg/8*8)
    35                        .ENDMACRO
    36                        
    37                        Lcd_byte:							;段码<==>SEG/COM表
    38                        lcd_table1:
    39                        lcd_d1 .equ	lcd_table1-lcd_table1
    40                        	db_c_s	c4,s0					;A1
+   40 00:F6FB: 18             .DB c4*$0006+s0/$0008
    41                        	db_c_s	c4,s1					;A2
+   41 00:F6FC: 18             .DB c4*$0006+s1/$0008
    42                        	db_c_s	c4,s2					;A3
+   42 00:F6FD: 18             .DB c4*$0006+s2/$0008
    43                        	db_c_s	c3,s0					;A4
+   43 00:F6FE: 12             .DB c3*$0006+s0/$0008
    44                        	db_c_s	c3,s1					;A5
+   44 00:F6FF: 12             .DB c3*$0006+s1/$0008
    45                        	db_c_s	c4,s3					;A6
+   45 00:F700: 18             .DB c4*$0006+s3/$0008
    46                        	db_c_s	c2,s0					;A7
+   46 00:F701: 0C             .DB c2*$0006+s0/$0008
    47                        	db_c_s	c3,s2					;A8
+   47 00:F702: 12             .DB c3*$0006+s2/$0008
    48                        	db_c_s	c3,s3					;A9
+   48 00:F703: 12             .DB c3*$0006+s3/$0008
    49                        	db_c_s	c2,s1					;A10
+   49 00:F704: 0C             .DB c2*$0006+s1/$0008
    50                        	db_c_s	c2,s2					;A11
+   50 00:F705: 0C             .DB c2*$0006+s2/$0008
    51                        	db_c_s	c2,s3					;A12
+   51 00:F706: 0C             .DB c2*$0006+s3/$0008
    52                        	db_c_s	c1,s0					;A13
+   52 00:F707: 06             .DB c1*$0006+s0/$0008
    53                        	db_c_s	c1,s3					;A14
+   53 00:F708: 06             .DB c1*$0006+s3/$0008
    54                        	db_c_s	c1,s4					;A15
+   54 00:F709: 06             .DB c1*$0006+s4/$0008
    55                        	db_c_s	c1,s1					;A16
+   55 00:F70A: 06             .DB c1*$0006+s1/$0008
    56                        	db_c_s	c1,s2					;A17
+   56 00:F70B: 06             .DB c1*$0006+s2/$0008
    57                        	db_c_s	c0,s3					;A18
+   57 00:F70C: 00             .DB c0*$0006+s3/$0008
    58                        	db_c_s	c0,s0					;A19
+   58 00:F70D: 00             .DB c0*$0006+s0/$0008
    59                        	db_c_s	c0,s1					;A20
+   59 00:F70E: 00             .DB c0*$0006+s1/$0008
    60                        	db_c_s	c0,s2					;A21
+   60 00:F70F: 00             .DB c0*$0006+s2/$0008
    61                        
    62                        lcd_d2	.equ lcd_d1+21
    63                        	db_c_s	c4,s5					;B1
+   63 00:F710: 18             .DB c4*$0006+s5/$0008
    64                        	db_c_s	c4,s6					;B2
+   64 00:F711: 18             .DB c4*$0006+s6/$0008
    65                        	db_c_s	c4,s7					;B3
+   65 00:F712: 18             .DB c4*$0006+s7/$0008
    66                        	db_c_s	c4,s4					;B4
+   66 00:F713: 18             .DB c4*$0006+s4/$0008
    67                        	db_c_s	c3,s6					;B5
+   67 00:F714: 12             .DB c3*$0006+s6/$0008
    68                        	db_c_s	c3,s7					;B6
+   68 00:F715: 12             .DB c3*$0006+s7/$0008
    69                        	db_c_s	c3,s4					;B7
+   69 00:F716: 12             .DB c3*$0006+s4/$0008
    70                        	db_c_s	c3,s5					;B8
+   70 00:F717: 12             .DB c3*$0006+s5/$0008
    71                        	db_c_s	c2,s8					;B9
+   71 00:F718: 0D             .DB c2*$0006+s8/$0008
    72                        	db_c_s	c2,s4					;B10
+   72 00:F719: 0C             .DB c2*$0006+s4/$0008
    73                        	db_c_s	c2,s6					;B11
+   73 00:F71A: 0C             .DB c2*$0006+s6/$0008
    74                        	db_c_s	c2,s7					;B12
+   74 00:F71B: 0C             .DB c2*$0006+s7/$0008
    75                        	db_c_s	c2,s5					;B13
+   75 00:F71C: 0C             .DB c2*$0006+s5/$0008
    76                        	db_c_s	c1,s7					;B14
+   76 00:F71D: 06             .DB c1*$0006+s7/$0008
    77                        	db_c_s	c1,s8					;B15
+   77 00:F71E: 07             .DB c1*$0006+s8/$0008
    78                        	db_c_s	c1,s5					;B16
+   78 00:F71F: 06             .DB c1*$0006+s5/$0008
    79                        	db_c_s	c1,s6					;B17
+   79 00:F720: 06             .DB c1*$0006+s6/$0008
    80                        	db_c_s	c0,s7					;B18
+   80 00:F721: 00             .DB c0*$0006+s7/$0008
    81                        	db_c_s	c0,s4					;B19
+   81 00:F722: 00             .DB c0*$0006+s4/$0008
    82                        	db_c_s	c0,s5					;B20
+   82 00:F723: 00             .DB c0*$0006+s5/$0008
    83                        	db_c_s	c0,s6					;B21
+   83 00:F724: 00             .DB c0*$0006+s6/$0008
    84                        
    85                        lcd_d3	.equ lcd_d2+21
    86                        	db_c_s	c4,s8					;C1
+   86 00:F725: 19             .DB c4*$0006+s8/$0008
    87                        	db_c_s	c4,s9					;C2
+   87 00:F726: 19             .DB c4*$0006+s9/$0008
    88                        	db_c_s	c4,s10					;C3
+   88 00:F727: 19             .DB c4*$0006+s10/$0008
    89                        	db_c_s	c3,s8					;C4
+   89 00:F728: 13             .DB c3*$0006+s8/$0008
    90                        	db_c_s	c3,s11					;C5
+   90 00:F729: 13             .DB c3*$0006+s11/$0008
    91                        	db_c_s	c4,s11					;C6
+   91 00:F72A: 19             .DB c4*$0006+s11/$0008
    92                        	db_c_s	c3,s9					;C7
+   92 00:F72B: 13             .DB c3*$0006+s9/$0008
    93                        	db_c_s	c3,s10					;C8
+   93 00:F72C: 13             .DB c3*$0006+s10/$0008
    94                        	db_c_s	c3,s12					;C9
+   94 00:F72D: 13             .DB c3*$0006+s12/$0008
    95                        	db_c_s	c2,s9					;C10
+   95 00:F72E: 0D             .DB c2*$0006+s9/$0008
    96                        	db_c_s	c2,s10					;C11
+   96 00:F72F: 0D             .DB c2*$0006+s10/$0008
    97                        	db_c_s	c2,s11					;C12
+   97 00:F730: 0D             .DB c2*$0006+s11/$0008
    98                        	db_c_s	c1,s9					;C13
+   98 00:F731: 07             .DB c1*$0006+s9/$0008
    99                        	db_c_s	c1,s10					;C14
+   99 00:F732: 07             .DB c1*$0006+s10/$0008
   100                        	db_c_s	c2,s12					;C15
+  100 00:F733: 0D             .DB c2*$0006+s12/$0008
   101                        	db_c_s	c0,s8					;C16
+  101 00:F734: 01             .DB c0*$0006+s8/$0008
   102                        	db_c_s	c1,s11					;C17
+  102 00:F735: 07             .DB c1*$0006+s11/$0008
   103                        	db_c_s	c1,s12					;C18
+  103 00:F736: 07             .DB c1*$0006+s12/$0008
   104                        	db_c_s	c0,s9					;C19
+  104 00:F737: 01             .DB c0*$0006+s9/$0008
   105                        	db_c_s	c0,s10					;C20
+  105 00:F738: 01             .DB c0*$0006+s10/$0008
   106                        	db_c_s	c0,s11					;C21
+  106 00:F739: 01             .DB c0*$0006+s11/$0008
   107                        
   108                        lcd_d4	.equ lcd_d3+21
   109                        	db_c_s	c4,s13					;D1
+  109 00:F73A: 19             .DB c4*$0006+s13/$0008
   110                        	db_c_s	c4,s14					;D2
+  110 00:F73B: 19             .DB c4*$0006+s14/$0008
   111                        	db_c_s	c4,s15					;D3
+  111 00:F73C: 19             .DB c4*$0006+s15/$0008
   112                        	db_c_s	c4,s12					;D4
+  112 00:F73D: 19             .DB c4*$0006+s12/$0008
   113                        	db_c_s	c3,s15					;D5
+  113 00:F73E: 13             .DB c3*$0006+s15/$0008
   114                        	db_c_s	c3,s40					;D6
+  114 00:F73F: 17             .DB c3*$0006+s40/$0008
   115                        	db_c_s	c3,s13					;D7
+  115 00:F740: 13             .DB c3*$0006+s13/$0008
   116                        	db_c_s	c3,s14					;D8
+  116 00:F741: 13             .DB c3*$0006+s14/$0008
   117                        	db_c_s	c2,s40					;D9
+  117 00:F742: 11             .DB c2*$0006+s40/$0008
   118                        	db_c_s	c2,s13					;D10
+  118 00:F743: 0D             .DB c2*$0006+s13/$0008
   119                        	db_c_s	c2,s14					;D11
+  119 00:F744: 0D             .DB c2*$0006+s14/$0008
   120                        	db_c_s	c2,s15					;D12
+  120 00:F745: 0D             .DB c2*$0006+s15/$0008
   121                        	db_c_s	c1,s14					;D13
+  121 00:F746: 07             .DB c1*$0006+s14/$0008
   122                        	db_c_s	c1,s15					;D14
+  122 00:F747: 07             .DB c1*$0006+s15/$0008
   123                        	db_c_s	c1,s40					;D15
+  123 00:F748: 0B             .DB c1*$0006+s40/$0008
   124                        	db_c_s	c1,s13					;D16
+  124 00:F749: 07             .DB c1*$0006+s13/$0008
   125                        	db_c_s	c0,s14					;D17
+  125 00:F74A: 01             .DB c0*$0006+s14/$0008
   126                        	db_c_s	c0,s15					;D18
+  126 00:F74B: 01             .DB c0*$0006+s15/$0008
   127                        	db_c_s	c0,s12					;D19
+  127 00:F74C: 01             .DB c0*$0006+s12/$0008
   128                        	db_c_s	c0,s13					;D20
+  128 00:F74D: 01             .DB c0*$0006+s13/$0008
   129                        	db_c_s	c0,s40					;D21
+  129 00:F74E: 05             .DB c0*$0006+s40/$0008
   130                        
   131                        lcd_dot:
   132                        lcd_MS .equ lcd_dot-lcd_table1
   133                        	db_c_s	c4,s40					;MS
+  133 00:F74F: 1D             .DB c4*$0006+s40/$0008
   134                        
   135                        ;==========================================================
   136                        ;==========================================================
   137                        
   138                        Lcd_bit:
   139                        	db_c_y	c4,s0					;A1
+  139 00:F750: 01             .DB $0001<<(s0-s0/$0008*$0008)
   140                        	db_c_y	c4,s1					;A2
+  140 00:F751: 02             .DB $0001<<(s1-s1/$0008*$0008)
   141                        	db_c_y	c4,s2					;A3
+  141 00:F752: 04             .DB $0001<<(s2-s2/$0008*$0008)
   142                        	db_c_y	c3,s0					;A4
+  142 00:F753: 01             .DB $0001<<(s0-s0/$0008*$0008)
   143                        	db_c_y	c3,s1					;A5
+  143 00:F754: 02             .DB $0001<<(s1-s1/$0008*$0008)
   144                        	db_c_y	c4,s3					;A6
+  144 00:F755: 08             .DB $0001<<(s3-s3/$0008*$0008)
   145                        	db_c_y	c2,s0					;A7
+  145 00:F756: 01             .DB $0001<<(s0-s0/$0008*$0008)
   146                        	db_c_y	c3,s2					;A8
+  146 00:F757: 04             .DB $0001<<(s2-s2/$0008*$0008)
   147                        	db_c_y	c3,s3					;A9
+  147 00:F758: 08             .DB $0001<<(s3-s3/$0008*$0008)
   148                        	db_c_y	c2,s1					;A10
+  148 00:F759: 02             .DB $0001<<(s1-s1/$0008*$0008)
   149                        	db_c_y	c2,s2					;A11
+  149 00:F75A: 04             .DB $0001<<(s2-s2/$0008*$0008)
   150                        	db_c_y	c2,s3					;A12
+  150 00:F75B: 08             .DB $0001<<(s3-s3/$0008*$0008)
   151                        	db_c_y	c1,s0					;A13
+  151 00:F75C: 01             .DB $0001<<(s0-s0/$0008*$0008)
   152                        	db_c_y	c1,s3					;A14
+  152 00:F75D: 08             .DB $0001<<(s3-s3/$0008*$0008)
   153                        	db_c_y	c1,s4					;A15
+  153 00:F75E: 10             .DB $0001<<(s4-s4/$0008*$0008)
   154                        	db_c_y	c1,s1					;A16
+  154 00:F75F: 02             .DB $0001<<(s1-s1/$0008*$0008)
   155                        	db_c_y	c1,s2					;A17
+  155 00:F760: 04             .DB $0001<<(s2-s2/$0008*$0008)
   156                        	db_c_y	c0,s3					;A18
+  156 00:F761: 08             .DB $0001<<(s3-s3/$0008*$0008)
   157                        	db_c_y	c0,s0					;A19
+  157 00:F762: 01             .DB $0001<<(s0-s0/$0008*$0008)
   158                        	db_c_y	c0,s1					;A20
+  158 00:F763: 02             .DB $0001<<(s1-s1/$0008*$0008)
   159                        	db_c_y	c0,s2					;A21
+  159 00:F764: 04             .DB $0001<<(s2-s2/$0008*$0008)
   160                        
   161                        	db_c_y	c4,s5					;B1
+  161 00:F765: 20             .DB $0001<<(s5-s5/$0008*$0008)
   162                        	db_c_y	c4,s6					;B2
+  162 00:F766: 40             .DB $0001<<(s6-s6/$0008*$0008)
   163                        	db_c_y	c4,s7					;B3
+  163 00:F767: 80             .DB $0001<<(s7-s7/$0008*$0008)
   164                        	db_c_y	c4,s4					;B4
+  164 00:F768: 10             .DB $0001<<(s4-s4/$0008*$0008)
   165                        	db_c_y	c3,s6					;B5
+  165 00:F769: 40             .DB $0001<<(s6-s6/$0008*$0008)
   166                        	db_c_y	c3,s7					;B6
+  166 00:F76A: 80             .DB $0001<<(s7-s7/$0008*$0008)
   167                        	db_c_y	c3,s4					;B7
+  167 00:F76B: 10             .DB $0001<<(s4-s4/$0008*$0008)
   168                        	db_c_y	c3,s5					;B8
+  168 00:F76C: 20             .DB $0001<<(s5-s5/$0008*$0008)
   169                        	db_c_y	c2,s8					;B9
+  169 00:F76D: 01             .DB $0001<<(s8-s8/$0008*$0008)
   170                        	db_c_y	c2,s4					;B10
+  170 00:F76E: 10             .DB $0001<<(s4-s4/$0008*$0008)
   171                        	db_c_y	c2,s6					;B11
+  171 00:F76F: 40             .DB $0001<<(s6-s6/$0008*$0008)
   172                        	db_c_y	c2,s7					;B12
+  172 00:F770: 80             .DB $0001<<(s7-s7/$0008*$0008)
   173                        	db_c_y	c2,s5					;B13
+  173 00:F771: 20             .DB $0001<<(s5-s5/$0008*$0008)
   174                        	db_c_y	c1,s7					;B14
+  174 00:F772: 80             .DB $0001<<(s7-s7/$0008*$0008)
   175                        	db_c_y	c1,s8					;B15
+  175 00:F773: 01             .DB $0001<<(s8-s8/$0008*$0008)
   176                        	db_c_y	c1,s5					;B16
+  176 00:F774: 20             .DB $0001<<(s5-s5/$0008*$0008)
   177                        	db_c_y	c1,s6					;B17
+  177 00:F775: 40             .DB $0001<<(s6-s6/$0008*$0008)
   178                        	db_c_y	c0,s7					;B18
+  178 00:F776: 80             .DB $0001<<(s7-s7/$0008*$0008)
   179                        	db_c_y	c0,s4					;B19
+  179 00:F777: 10             .DB $0001<<(s4-s4/$0008*$0008)
   180                        	db_c_y	c0,s5					;B20
+  180 00:F778: 20             .DB $0001<<(s5-s5/$0008*$0008)
   181                        	db_c_y	c0,s6					;B21
+  181 00:F779: 40             .DB $0001<<(s6-s6/$0008*$0008)
   182                        
   183                        	db_c_y	c4,s8					;C1
+  183 00:F77A: 01             .DB $0001<<(s8-s8/$0008*$0008)
   184                        	db_c_y	c4,s9					;C2
+  184 00:F77B: 02             .DB $0001<<(s9-s9/$0008*$0008)
   185                        	db_c_y	c4,s10					;C3
+  185 00:F77C: 04             .DB $0001<<(s10-s10/$0008*$0008)
   186                        	db_c_y	c3,s8					;C4
+  186 00:F77D: 01             .DB $0001<<(s8-s8/$0008*$0008)
   187                        	db_c_y	c3,s11					;C5
+  187 00:F77E: 08             .DB $0001<<(s11-s11/$0008*$0008)
   188                        	db_c_y	c4,s11					;C6
+  188 00:F77F: 08             .DB $0001<<(s11-s11/$0008*$0008)
   189                        	db_c_y	c3,s9					;C7
+  189 00:F780: 02             .DB $0001<<(s9-s9/$0008*$0008)
   190                        	db_c_y	c3,s10					;C8
+  190 00:F781: 04             .DB $0001<<(s10-s10/$0008*$0008)
   191                        	db_c_y	c3,s12					;C9
+  191 00:F782: 10             .DB $0001<<(s12-s12/$0008*$0008)
   192                        	db_c_y	c2,s9					;C10
+  192 00:F783: 02             .DB $0001<<(s9-s9/$0008*$0008)
   193                        	db_c_y	c2,s10					;C11
+  193 00:F784: 04             .DB $0001<<(s10-s10/$0008*$0008)
   194                        	db_c_y	c2,s11					;C12
+  194 00:F785: 08             .DB $0001<<(s11-s11/$0008*$0008)
   195                        	db_c_y	c1,s9					;C13
+  195 00:F786: 02             .DB $0001<<(s9-s9/$0008*$0008)
   196                        	db_c_y	c1,s10					;C14
+  196 00:F787: 04             .DB $0001<<(s10-s10/$0008*$0008)
   197                        	db_c_y	c2,s12					;C15
+  197 00:F788: 10             .DB $0001<<(s12-s12/$0008*$0008)
   198                        	db_c_y	c0,s8					;C16
+  198 00:F789: 01             .DB $0001<<(s8-s8/$0008*$0008)
   199                        	db_c_y	c1,s11					;C17
+  199 00:F78A: 08             .DB $0001<<(s11-s11/$0008*$0008)
   200                        	db_c_y	c1,s12					;C18
+  200 00:F78B: 10             .DB $0001<<(s12-s12/$0008*$0008)
   201                        	db_c_y	c0,s9					;C19
+  201 00:F78C: 02             .DB $0001<<(s9-s9/$0008*$0008)
   202                        	db_c_y	c0,s10					;C20
+  202 00:F78D: 04             .DB $0001<<(s10-s10/$0008*$0008)
   203                        	db_c_y	c0,s11					;C21
+  203 00:F78E: 08             .DB $0001<<(s11-s11/$0008*$0008)
   204                        
   205                        	db_c_y	c4,s13					;D1
+  205 00:F78F: 20             .DB $0001<<(s13-s13/$0008*$0008)
   206                        	db_c_y	c4,s14					;D2
+  206 00:F790: 40             .DB $0001<<(s14-s14/$0008*$0008)
   207                        	db_c_y	c4,s15					;D3
+  207 00:F791: 80             .DB $0001<<(s15-s15/$0008*$0008)
   208                        	db_c_y	c4,s12					;D4
+  208 00:F792: 10             .DB $0001<<(s12-s12/$0008*$0008)
   209                        	db_c_y	c3,s15					;D5
+  209 00:F793: 80             .DB $0001<<(s15-s15/$0008*$0008)
   210                        	db_c_y	c3,s40					;D6
+  210 00:F794: 01             .DB $0001<<(s40-s40/$0008*$0008)
   211                        	db_c_y	c3,s13					;D7
+  211 00:F795: 20             .DB $0001<<(s13-s13/$0008*$0008)
   212                        	db_c_y	c3,s14					;D8
+  212 00:F796: 40             .DB $0001<<(s14-s14/$0008*$0008)
   213                        	db_c_y	c2,s40					;D9
+  213 00:F797: 01             .DB $0001<<(s40-s40/$0008*$0008)
   214                        	db_c_y	c2,s13					;D10
+  214 00:F798: 20             .DB $0001<<(s13-s13/$0008*$0008)
   215                        	db_c_y	c2,s14					;D11
+  215 00:F799: 40             .DB $0001<<(s14-s14/$0008*$0008)
   216                        	db_c_y	c2,s15					;D12
+  216 00:F79A: 80             .DB $0001<<(s15-s15/$0008*$0008)
   217                        	db_c_y	c1,s14					;D13
+  217 00:F79B: 40             .DB $0001<<(s14-s14/$0008*$0008)
   218                        	db_c_y	c1,s15					;D14
+  218 00:F79C: 80             .DB $0001<<(s15-s15/$0008*$0008)
   219                        	db_c_y	c1,s40					;D15
+  219 00:F79D: 01             .DB $0001<<(s40-s40/$0008*$0008)
   220                        	db_c_y	c1,s13					;D16
+  220 00:F79E: 20             .DB $0001<<(s13-s13/$0008*$0008)
   221                        	db_c_y	c0,s14					;D17
+  221 00:F79F: 40             .DB $0001<<(s14-s14/$0008*$0008)
   222                        	db_c_y	c0,s15					;D18
+  222 00:F7A0: 80             .DB $0001<<(s15-s15/$0008*$0008)
   223                        	db_c_y	c0,s12					;D19
+  223 00:F7A1: 10             .DB $0001<<(s12-s12/$0008*$0008)
   224                        	db_c_y	c0,s13					;D20
+  224 00:F7A2: 20             .DB $0001<<(s13-s13/$0008*$0008)
   225                        	db_c_y	c0,s40					;D21
+  225 00:F7A3: 01             .DB $0001<<(s40-s40/$0008*$0008)
   226                        
   227                        	db_c_y	c4,s40					;MS
+  227 00:F7A4: 01             .DB $0001<<(s40-s40/$0008*$0008)
   228                        ;=========================================
   228                        
   196                        .INCLUDE	Display.asm
     1                        F_Display_Time:
     2                            ; 调用显示函数显示当前时间
     3 00:F7A5: 15 35 F4      	JSR 	F_ClearScreen
     4 00:F7A8: 15 AF F7          JSR 	L_DisTimer_Sec
     5 00:F7AB: 15 C7 F7          JSR 	L_DisTimer_Min
     6 00:F7AE: 09                RTS
     7                        L_DisTimer_Sec:
     8 00:F7AF: 73 B4         	LDA		R_Time_Sec
     9 00:F7B1: 1B            	TAX
    10 00:F7B2: 63 5B F8      	LDA		Table_Sec_DataDot,X
    11 00:F7B5: 0A            	PHA
    12 00:F7B6: 51 0F         	AND		#$0F
    13 00:F7B8: 5E 3F         	LDX		#lcd_d4
    14 00:F7BA: 15 65 F4      	JSR		L_Dis_21Bit_DigitDot_Prog
    15 00:F7BD: 0C            	PLA
    16 00:F7BE: 15 43 F8      	JSR		L_ROR_4Bit_Prog
    17 00:F7C1: 5E 2A         	LDX		#lcd_d3
    18 00:F7C3: 15 65 F4      	JSR		L_Dis_21Bit_DigitDot_Prog
    19 00:F7C6: 09            	RTS
    20                        L_DisTimer_Min:
    21 00:F7C7: 73 B5         	LDA		R_Time_Min
    22 00:F7C9: 1B            	TAX
    23 00:F7CA: 63 98 F8      	LDA		Table_Min_DataDot,X
    24 00:F7CD: 0A            	PHA
    25 00:F7CE: 51 0F         	AND		#$0F
    26 00:F7D0: 5E 15         	LDX		#lcd_d2
    27 00:F7D2: 15 65 F4      	JSR		L_Dis_21Bit_DigitDot_Prog
    28 00:F7D5: 0C            	PLA
    29 00:F7D6: 51 F0         	AND		#$F0
    30 00:F7D8: 15 43 F8      	JSR		L_ROR_4Bit_Prog
    31 00:F7DB: 5E 00         	LDX		#lcd_d1
    32 00:F7DD: 15 65 F4      	JSR		L_Dis_21Bit_DigitDot_Prog
    33 00:F7E0: 09            	RTS
    34                        
    35                        F_DisFrame_Sec_d4:
    36 00:F7E1: 73 B4         	lda		R_Time_Sec
    37 00:F7E3: 3A AC 01      	bbs2	Sys_Status_Flag,Des_Frame_Cnt4		; 倒计时预-1不需要修正
    38 00:F7E6: 07            	dea											; 计数动画要-1修正
    39                        Des_Frame_Cnt4:										; 计数动画要-1修正
    40 00:F7E7: 1B            	tax
    41 00:F7E8: 63 5B F8      	lda		Table_Sec_DataDot,X
    42 00:F7EB: 51 0F         	and		#$0f								; 个位数字
    43 00:F7ED: 04            	clc
    44 00:F7EE: 18            	rol											; 乘8
    45 00:F7EF: 18            	rol
    46 00:F7F0: 18            	rol
    47 00:F7F1: 04            	clc
    48 00:F7F2: 74 A9         	adc		Frame_Counter
    49 00:F7F4: 5E 3F         	ldx		#lcd_d4
    50 00:F7F6: 15 D3 F4      	jsr		L_Dis_21Bit_DigitFrame_Prog
    51 00:F7F9: 09            	rts
    52                        
    53                        F_DisFrame_Sec_d3:
    54 00:F7FA: 73 B4         	lda		R_Time_Sec
    55 00:F7FC: 1B            	tax
    56 00:F7FD: 63 5B F8      	lda		Table_Sec_DataDot,X
    57 00:F800: 51 F0         	and		#$f0								; 十位数字
    58 00:F802: 15 43 F8      	jsr		L_ROR_4Bit_Prog
    59 00:F805: 3A AC 01      	bbs2	Sys_Status_Flag,Des_Frame_Cnt3		; 倒计时预-1不需要修正
    60 00:F808: 07            	dea											; 计数动画要-1修正
    61                        Des_Frame_Cnt3:
    62 00:F809: 04            	clc
    63 00:F80A: 18            	rol											; 乘8
    64 00:F80B: 18            	rol
    65 00:F80C: 18            	rol
    66 00:F80D: 04            	clc
    67 00:F80E: 74 A9         	adc		Frame_Counter
    68 00:F810: 5E 2A         	ldx		#lcd_d3
    69 00:F812: 15 24 F5      	jsr		L_Dis_21Bit_DigitFrame_Prog_1
    70 00:F815: 09            	rts
    71                        
    72                        F_DisFrame_Min_d2:
    73 00:F816: 73 B5         	lda		R_Time_Min
    74 00:F818: 1B            	tax
    75 00:F819: 63 98 F8      	lda		Table_Min_DataDot,X
    76 00:F81C: 51 0F         	and		#$0f
    77 00:F81E: 04            	clc
    78 00:F81F: 18            	rol											; 乘8
    79 00:F820: 18            	rol
    80 00:F821: 18            	rol
    81 00:F822: 04            	clc
    82 00:F823: 74 A9         	adc		Frame_Counter
    83 00:F825: 5E 15         	ldx		#lcd_d2
    84 00:F827: 15 D3 F4      	jsr		L_Dis_21Bit_DigitFrame_Prog
    85 00:F82A: 09            	rts
    86                        
    87                        F_DisFrame_Min_d1:
    88 00:F82B: 73 B5         	lda		R_Time_Min
    89 00:F82D: 1B            	tax
    90 00:F82E: 63 98 F8      	lda		Table_Min_DataDot,X
    91 00:F831: 51 F0         	and		#$f0
    92 00:F833: 15 43 F8      	jsr		L_ROR_4Bit_Prog
    93 00:F836: 04            	clc
    94 00:F837: 18            	rol											; 乘8
    95 00:F838: 18            	rol
    96 00:F839: 18            	rol											; 右移4位再乘8,就是右移1位
    97 00:F83A: 04            	clc
    98 00:F83B: 74 A9         	adc		Frame_Counter
    99 00:F83D: 5E 00         	ldx		#lcd_d1
   100 00:F83F: 15 D3 F4      	jsr		L_Dis_21Bit_DigitFrame_Prog
   101                        
   102 00:F842: 09            	rts
   103                        
   104                        
   105                        L_ROR_4Bit_Prog:
   106 00:F843: 19            	ROR
   107 00:F844: 19            	ROR
   108 00:F845: 19            	ROR
   109 00:F846: 19            	ROR
   110 00:F847: 51 0F         	AND		#$0F
   111                        
   112 00:F849: 09            	RTS
   113                        
   114                        ;a = num
   115                        L_Multi_24_Prog:
   116 00:F84A: 04            	CLC									; 清除进位标志，确保进位为0
   117 00:F84B: 1B            	TAX									; 将A保存到X中
   118                            ; 进行乘以 8 的操作
   119 00:F84C: 18            	ROL									; A = A * 2
   120 00:F84D: 18            	ROL									; A = A * 4
   121 00:F84E: 18            	ROL									; A = A * 8
   122 00:F84F: 7F B7         	STA		P_Temp+1
   123                        	; 进行乘以 16 的操作
   124 00:F851: 1C            	TXA									; 恢复X中的原始A值
   125 00:F852: 04            	CLC
   126 00:F853: 18            	ROL									; A = A * 2
   127 00:F854: 18            	ROL									; A = A * 4
   128 00:F855: 18            	ROL									; A = A * 8
   129 00:F856: 18            	ROL									; A = A * 16
   130 00:F857: 04            	CLC
   131 00:F858: 74 B7         	ADC		P_Temp+1					; 乘24得到表中0-9数字
   132 00:F85A: 09            	rts
   133                        ;================================================
   134                        ;********************************************
   135                        Table_Sec_DataDot:		;显示秒对应显示的16进制
   136 00:F85B: 00            	.BYTE 	00h	;0
   137 00:F85C: 01            	.BYTE 	01h	;1
   138 00:F85D: 02            	.BYTE	02h	;2
   139 00:F85E: 03            	.BYTE	03h	;3
   140 00:F85F: 04            	.BYTE	04h	;4
   141 00:F860: 05            	.BYTE	05h	;5
   142 00:F861: 06            	.BYTE	06h	;6
   143 00:F862: 07            	.BYTE	07h	;7
   144 00:F863: 08            	.BYTE	08h	;8
   145 00:F864: 09            	.BYTE	09h	;9
   146 00:F865: 10            	.BYTE	10h	;10
   147 00:F866: 11            	.BYTE 	11h	;11
   148 00:F867: 12            	.BYTE	12h	;12
   149 00:F868: 13            	.BYTE	13h	;13
   150 00:F869: 14            	.BYTE	14h	;14
   151 00:F86A: 15            	.BYTE	15h	;15
   152 00:F86B: 16            	.BYTE 	16h	;16
   153 00:F86C: 17            	.BYTE 	17h	;17
   154 00:F86D: 18            	.BYTE	18h	;18
   155 00:F86E: 19            	.BYTE	19h	;19
   156 00:F86F: 20            	.BYTE	20h	;20
   157 00:F870: 21            	.BYTE	21h	;21
   158 00:F871: 22            	.BYTE	22h	;22
   159 00:F872: 23            	.BYTE	23h	;23
   160 00:F873: 24            	.BYTE	24h	;24
   161 00:F874: 25            	.BYTE	25h	;25
   162 00:F875: 26            	.BYTE	26h	;26
   163 00:F876: 27            	.BYTE 	27h	;27
   164 00:F877: 28            	.BYTE	28h	;28
   165 00:F878: 29            	.BYTE	29h	;29
   166 00:F879: 30            	.BYTE	30h	;30
   167 00:F87A: 31            	.BYTE	31h	;31
   168 00:F87B: 32            	.BYTE 	32h	;32
   169 00:F87C: 33            	.BYTE 	33h	;33
   170 00:F87D: 34            	.BYTE	34h	;34
   171 00:F87E: 35            	.BYTE	35h	;35
   172 00:F87F: 36            	.BYTE	36h	;36
   173 00:F880: 37            	.BYTE	37h	;37
   174 00:F881: 38            	.BYTE	38h	;38
   175 00:F882: 39            	.BYTE	39h	;39
   176 00:F883: 40            	.BYTE	40h	;40
   177 00:F884: 41            	.BYTE	41h	;41
   178 00:F885: 42            	.BYTE	42h	;42
   179 00:F886: 43            	.BYTE 	43h	;43
   180 00:F887: 44            	.BYTE	44h	;44
   181 00:F888: 45            	.BYTE	45h	;45
   182 00:F889: 46            	.BYTE	46h	;46
   183 00:F88A: 47            	.BYTE	47h	;47
   184 00:F88B: 48            	.BYTE 	48h	;48
   185 00:F88C: 49            	.BYTE 	49h	;49
   186 00:F88D: 50            	.BYTE	50h	;50
   187 00:F88E: 51            	.BYTE	51h	;51
   188 00:F88F: 52            	.BYTE	52h	;52
   189 00:F890: 53            	.BYTE	53h	;53
   190 00:F891: 54            	.BYTE	54h	;54
   191 00:F892: 55            	.BYTE	55h	;55
   192 00:F893: 56            	.BYTE	56h	;56
   193 00:F894: 57            	.BYTE	57h	;57
   194 00:F895: 58            	.BYTE	58h	;58
   195 00:F896: 59            	.BYTE 	59h	;59
   196 00:F897: 60            	.BYTE 	60h	;60
   197                        
   198                        Table_Min_DataDot:		;显示分钟对应显示的16进制
   199 00:F898: 00            	.BYTE 	00h	;0
   200 00:F899: 01            	.BYTE 	01h	;1
   201 00:F89A: 02            	.BYTE	02h	;2
   202 00:F89B: 03            	.BYTE	03h	;3
   203 00:F89C: 04            	.BYTE	04h	;4
   204 00:F89D: 05            	.BYTE	05h	;5
   205 00:F89E: 06            	.BYTE	06h	;6
   206 00:F89F: 07            	.BYTE	07h	;7
   207 00:F8A0: 08            	.BYTE	08h	;8
   208 00:F8A1: 09            	.BYTE	09h	;9
   209 00:F8A2: 10            	.BYTE	10h	;10
   210 00:F8A3: 11            	.BYTE 	11h	;11
   211 00:F8A4: 12            	.BYTE	12h	;12
   212 00:F8A5: 13            	.BYTE	13h	;13
   213 00:F8A6: 14            	.BYTE	14h	;14
   214 00:F8A7: 15            	.BYTE	15h	;15
   215 00:F8A8: 16            	.BYTE 	16h	;16
   216 00:F8A9: 17            	.BYTE 	17h	;17
   217 00:F8AA: 18            	.BYTE	18h	;18
   218 00:F8AB: 19            	.BYTE	19h	;19
   219 00:F8AC: 20            	.BYTE	20h	;20
   220 00:F8AD: 21            	.BYTE	21h	;21
   221 00:F8AE: 22            	.BYTE	22h	;22
   222 00:F8AF: 23            	.BYTE	23h	;23
   223 00:F8B0: 24            	.BYTE	24h	;24
   224 00:F8B1: 25            	.BYTE	25h	;25
   225 00:F8B2: 26            	.BYTE	26h	;26
   226 00:F8B3: 27            	.BYTE 	27h	;27
   227 00:F8B4: 28            	.BYTE	28h	;28
   228 00:F8B5: 29            	.BYTE	29h	;29
   229 00:F8B6: 30            	.BYTE	30h	;30
   230 00:F8B7: 31            	.BYTE	31h	;31
   231 00:F8B8: 32            	.BYTE 	32h	;32
   232 00:F8B9: 33            	.BYTE 	33h	;33
   233 00:F8BA: 34            	.BYTE	34h	;34
   234 00:F8BB: 35            	.BYTE	35h	;35
   235 00:F8BC: 36            	.BYTE	36h	;36
   236 00:F8BD: 37            	.BYTE	37h	;37
   237 00:F8BE: 38            	.BYTE	38h	;38
   238 00:F8BF: 39            	.BYTE	39h	;39
   239 00:F8C0: 40            	.BYTE	40h	;40
   240 00:F8C1: 41            	.BYTE	41h	;41
   241 00:F8C2: 42            	.BYTE	42h	;42
   242 00:F8C3: 43            	.BYTE 	43h	;43
   243 00:F8C4: 44            	.BYTE	44h	;44
   244 00:F8C5: 45            	.BYTE	45h	;45
   245 00:F8C6: 46            	.BYTE	46h	;46
   246 00:F8C7: 47            	.BYTE	47h	;47
   247 00:F8C8: 48            	.BYTE 	48h	;48
   248 00:F8C9: 49            	.BYTE 	49h	;49
   249 00:F8CA: 50            	.BYTE	50h	;50
   250 00:F8CB: 51            	.BYTE	51h	;51
   251 00:F8CC: 52            	.BYTE	52h	;52
   252 00:F8CD: 53            	.BYTE	53h	;53
   253 00:F8CE: 54            	.BYTE	54h	;54
   254 00:F8CF: 55            	.BYTE	55h	;55
   255 00:F8D0: 56            	.BYTE	56h	;56
   256 00:F8D1: 57            	.BYTE	57h	;57
   257 00:F8D2: 58            	.BYTE	58h	;58
   258 00:F8D3: 59            	.BYTE 	59h	;59
   259 00:F8D4: 60            	.BYTE 	60h	;60
   260 00:F8D5: 61            	.BYTE 	61h	;61
   261 00:F8D6: 62            	.BYTE	62h	;62
   262 00:F8D7: 63            	.BYTE	63h	;63
   263 00:F8D8: 64            	.BYTE	64h	;64
   264 00:F8D9: 65            	.BYTE	65h	;65
   265 00:F8DA: 66            	.BYTE 	66h	;66
   266 00:F8DB: 67            	.BYTE 	67h	;67
   267 00:F8DC: 68            	.BYTE	68h	;68
   268 00:F8DD: 69            	.BYTE	69h	;69
   269 00:F8DE: 70            	.BYTE	70h	;70
   270 00:F8DF: 71            	.BYTE	71h	;71
   271 00:F8E0: 72            	.BYTE	72h	;72
   272 00:F8E1: 73            	.BYTE	73h	;73
   273 00:F8E2: 74            	.BYTE	74h	;74
   274 00:F8E3: 75            	.BYTE	75h	;75
   275 00:F8E4: 76            	.BYTE	76h	;76
   276 00:F8E5: 77            	.BYTE 	77h	;77
   277 00:F8E6: 78            	.BYTE	78h	;78
   278 00:F8E7: 79            	.BYTE	79h	;79
   279 00:F8E8: 80            	.BYTE	80h	;80
   280 00:F8E9: 81            	.BYTE	81h	;81
   281 00:F8EA: 82            	.BYTE 	82h	;82
   282 00:F8EB: 83            	.BYTE 	83h	;83
   283 00:F8EC: 84            	.BYTE	84h	;84
   284 00:F8ED: 85            	.BYTE	85h	;85
   285 00:F8EE: 86            	.BYTE	86h	;86
   286 00:F8EF: 87            	.BYTE	87h	;87
   287 00:F8F0: 88            	.BYTE	88h	;88
   288 00:F8F1: 89            	.BYTE	89h	;89
   289 00:F8F2: 90            	.BYTE	90h	;90
   290 00:F8F3: 91            	.BYTE	91h	;91
   291 00:F8F4: 92            	.BYTE	92h	;92
   292 00:F8F5: 93            	.BYTE 	93h	;93
   293 00:F8F6: 94            	.BYTE	94h	;94
   294 00:F8F7: 95            	.BYTE	95h	;95
   295 00:F8F8: 96            	.BYTE	96h	;96
   296 00:F8F9: 97            	.BYTE	97h	;97
   297 00:F8FA: 98            	.BYTE 	98h	;98
   298 00:F8FB: 99            	.BYTE 	99h	;99
   299 00:F8FC: 00            	.BYTE 	00h	;100
   299                        
   197                        .INCLUDE	Delay.asm
     1                        F_Delay_100ms:
     2 00:F8FD: 0A            	pha
     3                        	TMR2_ON
+    3 00:F8FE: 2A 16          SMB2 TMRC
     4 00:F900: 53 01         	lda			#$1
     5                        L_Delay_Tmp:
     6 00:F902: 37 AB FD      	bbr7		Timer_Flag,L_Delay_Tmp
     7 00:F905: 27 AB         	rmb7		Timer_Flag
     8 00:F907: 07            	dea
     9 00:F908: 12 F8         	bne			L_Delay_Tmp
    10                        
    11                        	TMR2_OFF
+   11 00:F90A: 22 16          RMB2 TMRC
    12 00:F90C: 0C            	pla
    13 00:F90D: 09            	rts
    14                        
    14                        
   198                        ;--------------------------------------------------------
   199                        ;***********************************************************************
   200 00:F90E: FF FF FF FF   	.BLKB	$FFFF-$,$FF
   200 00:F90E: FF FF FF FF   
   200 00:F90E: FF FF FF FF   
   201                        
   202                        	.ORG	0FFF8H
   203 00:FFF8: DF            	DB		11011111B	;3DH	;AC=PA3,bit54=01,4KBRom ;BR4M ;PA上拉或悬空
   204 00:FFF9: FE            	DB		11111110B	;Protect
   205                        ;***********************************************************************
   206                        	.ORG	0FFFCH
   207 00:FFFC: 00 F0         	DW		V_RESET
   208 00:FFFE: 88 F0         	DW		V_IRQ
   209                        
   210                        	.ENDS
   211                        	.END

 --------------------
      Warnings:0
      Errors  :0
