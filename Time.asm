F_Sec_Pos_Counter:
	lda		Timer_Flag
	and		#$81							; ?????16hz?????????????1
	cmp		#$80
	bne		L_Sec_Pos_rts
	rmb7	Timer_Flag

	inc		Frame_Counter

	lda		R_Time_Sec
	cmp		#60
	beq		L_CarryToMin					; ???¦Ë?????

	jsr		F_DisFrame_Sec_d4				; sec??¦Ë???????

	lda		R_Time_Sec						; ????¦Ë????§ß?¦Ë
	jsr		F_DivideBy10					; ????10????????????????0??????¦Ë?????
	cmp		#0								; ???0????????¦Ë??d3?????
	beq		L_Sec_D3_Out
	lda		P_Temp							; ???????0????????¦Ë
	cmp		#0
	bne		L_Sec_D3_Out

	jsr		F_DisFrame_Sec_d3				; sec?¦Ë???????

L_Sec_D3_Out:
	lda		Frame_Counter
	cmp		#$08
	beq		L_Sec_Pos_Out
	
	ldx		#lcd_MS
	jsr		F_ClrpSymbol

	rts

L_Sec_Pos_Out:
	ldx		#lcd_MS
	jsr		F_DispSymbol
	lda		#0
	sta		Frame_Counter

L_Sec_Pos_rts:
	rts

L_CarryToMin:
	lda		R_Time_Min
	cmp		#100
	beq		L_Time_Overflow					; ????99min59s??????

	jsr		F_DisFrame_Sec_d4				; Sec??¦Ë???????
	jsr		F_DisFrame_Sec_d3				; Sec?¦Ë???????
	jsr		F_DisFrame_Min_d2				; Min??¦Ë???????

	lda		R_Time_Min						; ????¦Ë????§ß?¦Ë
	jsr		F_DivideBy10					; ????10????????????????0??????¦Ë?????
	cmp		#0								; ???0????????¦Ë??d3?????
	beq		L_Min_D1_Out
	lda		P_Temp							; ???????0????????¦Ë
	cmp		#0
	bne		L_Min_D1_Out

	jsr		F_DisFrame_Min_d1				; Min?¦Ë???????

L_Min_D1_Out:
	lda		Frame_Counter
	cmp		#$08
	beq		L_Min_Pos_Out
	ldx		#lcd_MS
	jsr		F_ClrpSymbol
	rts

L_Min_Pos_Out:
	ldx		#lcd_MS
	jsr		F_DispSymbol
	lda		#0
	sta		Frame_Counter
	rts

L_Time_Overflow:
	lda		#$0c							; ????????????????????
	sta		Sys_Status_Flag
	lda		#99
	sta		R_Time_Min
	lda		#59
	sta		R_Time_Sec
	jsr		F_Display_Time
	rts

; ???????????????????
Pos_Time_Count:
	rmb1	Timer_Flag
	lda		R_Time_Sec
	cmp		#59
	beq		Count_Add_Min
	cmp		#60
	beq		Count_CarryToMin				; ?????????¦Ë??????
	inc		R_Time_Sec
	rts
Count_CarryToMin:
	lda		R_Time_Min
	cmp		#99
	beq		Count_Overflow
	lda		#$1
	sta		R_Time_Sec
	rts
Count_Add_Min:
	inc		R_Time_Sec
	inc		R_Time_Min
	rts
Count_Overflow:
	lda		#$0
	sta		R_Time_Sec
	sta		R_Time_Min
	TMR2_OFF
	TMR0_OFF
	rts


F_DivideBy10:
	ldx		#0								; ????? X ?????? 0????????
	sta		P_Temp							; ???????????
DivideBy10:
	cmp		#10								; ??? A ????????? 10
	bcc		Done							; ??? A §³?? 10??????? Done
	sec										; ?????¦Ë?????????
	sbc		#10								; A = A - 10
	inx										; X = X + 1???????
	bra		DivideBy10						; ?????§ß?¦Ë?????????
Done:
	sta		P_Temp							; ????(????)
	txa
	rts






; ?????????
F_Sec_Des_Counter:
	bbs0	Timer_Flag, Is_Frame_Come		; ?????0????§Ø??
	rts
; ?§Ø?????????????????????????
Is_Frame_Come:
	bbr1	Timer_Flag,Add_Sec_Out			; ????????????
	dec		R_Time_Sec
	rmb1	Timer_Flag						; ?????????8?????????1??
; ??16Hz?????????????
Add_Sec_Out:
	bbs7	Timer_Flag, Count_Start			; ??16Hz????????
	rts

Count_Start:
	lda		Frame_Counter					; ???????????????????
	dec		Frame_Counter					; ?????

	lda		R_Time_Sec						; ?§Ø?????§ß?¦Ë
	clc
	adc		#$01
	cmp		#$00
	bne		Set_BorrowFlag_Out				; ???¦Ë???????
	smb2	Frame_Flag
Set_BorrowFlag_Out:
	bbr2	Frame_Flag,Borrow_Out
	bra		L_BorrowToMin
Borrow_Out:
	jsr		F_DisFrame_Sec_d4				; sec??¦Ë???????

	lda		R_Time_Sec						; ??????¦Ë????§ß?¦Ë
	clc
	adc		#$01							; ???????????1??????????????1????????????????
	jsr		F_DivideBy10					; ????10????????????????0??????¦Ë?????
	cmp		#0								; ???0????????¦Ë??d3?????
	beq		L_Sec_D3_Out_Des
	lda		P_Temp							; ???????0????????¦Ë
	cmp		#0
	bne		L_Sec_D3_Out_Des

	jsr		F_DisFrame_Sec_d3				; sec?¦Ë???????


L_Sec_D3_Out_Des:
	lda		Frame_Counter					; ?????8????????????
	cmp		#$0
	beq		L_Sec_Des_Out

	ldx		#lcd_MS
	jsr		F_ClrpSymbol					; ????????????MS

	rmb7	Timer_Flag						; ???16Hz????????????16Hz???????????

	rts

L_Sec_Des_Out:
	rmb0	Timer_Flag						; ???§Ø???????????????
	rmb7	Timer_Flag						; ???16Hz???
	ldx		#lcd_MS							; ??MS???????????
	jsr		F_DispSymbol
	lda		#$8
	sta		Frame_Counter

L_Sec_Des_rts:
	rts

L_BorrowToMin:
	smb2	Frame_Flag
	bbs1	Frame_Flag,Dec_Once_Min			; ??¦Ë???????????8???????????????1??
	dec		R_Time_Min
	lda		#59
	sta		R_Time_Sec
	smb1	Frame_Flag
Dec_Once_Min:
	lda		R_Time_Min
	clc
	adc		#$01
	cmp		#$00
	beq		L_Time_Stop						; ???00:00????

	jsr		F_DisFrame_Sec_d4				; Sec??¦Ë???????
	jsr		F_DisFrame_Sec_d3				; Sec?¦Ë???????
	jsr		F_DisFrame_Min_d2				; Min??¦Ë???????

	lda		R_Time_Min						; ????¦Ë????§ß?¦Ë
	clc
	adc		#$01
	jsr		F_DivideBy10					; ????10????????????????0??????¦Ë?????
	cmp		#0								; ???0????????¦Ë??d3?????
	beq		L_Min_D1_Out_Des
	lda		P_Temp							; ???????0????????¦Ë
	cmp		#0
	bne		L_Min_D1_Out_Des

	jsr		F_DisFrame_Min_d1				; Min?¦Ë???????

L_Min_D1_Out_Des:
	lda		Frame_Counter					; ????????????MS
	cmp		#$0
	beq		L_Min_Des_Out
	ldx		#lcd_MS
	jsr		F_ClrpSymbol
	rts

L_Min_Des_Out:
	rmb1	Frame_Flag						; ??0??????¦Ë?????¦Í?¦Ë
	rmb2	Frame_Flag						; ???¦Ë???¦Ë???????????¦Ë????
	ldx		#lcd_MS							; ?????8????????????
	jsr		F_DispSymbol					; ????????????MS
	lda		#$8
	sta		Frame_Counter
	rts

L_Time_Stop:
	lda		#$01							; ????????????????
	sta		Sys_Status_Flag
	smb3	Timer_Flag						; ????????¦Ë
	lda		#$07							; ????????????
	sta		Beep_Serial
	lda		#$0
	sta		R_Time_Min
	sta		R_Time_Sec
	jsr		F_Display_Time
	rts
